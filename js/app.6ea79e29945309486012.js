"use strict";(self.webpackChunksim_firefighter=self.webpackChunksim_firefighter||[]).push([[524],{798:(e,t,i)=>{var s=i(440);class n extends Phaser.Scene{constructor(){super({key:"MenuScene"}),console.log("MenuScene Constructor Called")}preload(){this.load.image("game menu","assets/game-menu.png"),this.load.image("start tutorial","assets/tutorial icons/tutorial-button.png"),this.load.image("play game","assets/tutorial icons/play-button.png"),this.load.script("webfont","https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js")}create(){const e=this.cameras.main.centerX,t=this.cameras.main.centerY,i=this.cameras.main.width,s=this.cameras.main.height;WebFont.load({google:{families:["Press Start 2P"]},active:()=>{this.createMenuElements()}}),this.add.rectangle(e,t,i,s,2962486,.7);const n=this.add.image(e,t,"game menu").setOrigin(.5),o=i/n.width,r=s/n.height,a=Math.max(o,r);n.setScale(a).setAlpha(.5),this.add.text(e,t-150,"WILDFIRE COMMAND",{fontFamily:'"Press Start 2P"',fontSize:"45px",color:"#ffffff",stroke:"#ff6600",strokeThickness:6,shadow:{offsetX:2,offsetY:2,color:"#000",blur:2,stroke:!0,fill:!0}}).setOrigin(.5),this.createStyledButtons()}createMenuElements(){const e=this.cameras.main.centerX,t=this.cameras.main.centerY;this.add.text(e,t-90,"Firefighting Simulation",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#ffffff",align:"center"}).setOrigin(.5)}createStyledButtons(){const e=this.cameras.main.centerX,t=this.cameras.main.centerY,i=this.createButton(e,t-20,250,60,"Tutorial",2263842,(()=>{console.log("tutorial!"),this.scene.stop("MenuScene"),this.scene.start("TutorialScene")})),s=this.createButton(e,t+70,250,60,"Play Game",9109504,(()=>{console.log("play!"),this.scene.start("MapScene"),this.scene.launch("UIScene")}));this.tweens.add({targets:i,y:i.y-5,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.tweens.add({targets:s,y:s.y+5,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut",delay:200})}createButton(e,t,i,s,n,o,r){const a=this.add.container(e,t),l=this.add.rectangle(0,0,i,s,o,1).setStrokeStyle(3,16777215,.8).setOrigin(.5),h=this.add.text(0,0,n,{fontFamily:'"Press Start 2P"',fontSize:"18px",color:"#ffffff",align:"center"}).setOrigin(.5);return a.add([l,h]),l.setInteractive({useHandCursor:!0}).on("pointerover",(()=>{const e=2263842===o?3050327:10824234;l.setFillStyle(e),this.tweens.add({targets:a,scaleX:1.05,scaleY:1.05,duration:100})})).on("pointerout",(()=>{l.setFillStyle(o),this.tweens.add({targets:a,scaleX:1,scaleY:1,duration:100})})).on("pointerdown",(()=>{this.tweens.add({targets:a,scaleX:.95,scaleY:.95,duration:50,yoyo:!0,onComplete:r})})),a}}function o(e,{x:t,y:i,width:s=80,height:n=30,backgroundColor:o=9109504,hoverColor:r=10824234,text:a="Button",fontSize:l="10px",onClick:h=()=>{}}){const c=e.add.rectangle(t,i,s,n,o).setOrigin(.5).setInteractive().setScrollFactor(0).setDepth(10),d=e.add.text(t,i,a,{fontFamily:'"Press Start 2P"',fontStyle:"normal",fontSize:l,color:"#FFFFFF",align:"center"}).setOrigin(.5).setScrollFactor(0).setDepth(11);return c.on("pointerover",(()=>c.setFillStyle(r))),c.on("pointerout",(()=>c.setFillStyle(o))),c.on("pointerdown",(()=>{e.tweens.add({targets:[c,d],scaleX:.9,scaleY:.9,duration:100,ease:"Power2"})})),c.on("pointerup",(()=>{e.tweens.add({targets:[c,d],scaleX:1,scaleY:1,duration:100,ease:"Power2",onComplete:h})})),{button:c,buttonText:d}}let r=10,a=5,l=3,h=3,c=2,d=1,p=5;function u(){return r}function g(e){r+=e}function m(){return a}function f(e){a+=e}function x(){return l}function S(e){l+=e}function b(){return h}function y(e){h+=e}function T(){return c}function w(e){c+=e}function F(){return d}function C(e){d+=e}function I(){return p}function P(e){p+=e}class k extends Phaser.Scene{constructor(){super({key:"TutorialScene"}),console.log("TutorialScene Constructor Called")}preload(){this.load.image("page 1","assets/tutorial icons/page-1.png"),this.load.script("webfont","https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"),this.load.image("dialog","assets/tutorial/dialog.png"),this.load.image("firefighter","assets/tutorial/firefighter.png")}create(){this.cameras.main.centerX,this.cameras.main.centerY,this.cameras.main.width,this.cameras.main.height,"undefined"!=typeof WebFont?WebFont.load({google:{families:["Press Start 2P"]},active:()=>{this.scene.launch("MapScene"),this.time.delayedCall(2e3,(()=>this.createTutorialContent()))}}):(this.scene.launch("MapScene"),this.time.delayedCall(2e3,(()=>this.createTutorialContent())))}createTutorialContent(e){this.scene.bringToTop("TutorialScene");const t=this.cameras.main.centerX,i=this.cameras.main.centerY,s=this.cameras.main.width,n=this.cameras.main.height,u=this.add.rectangle(t,i,s,n,2962486).setAlpha(.9);o(this,{x:t-360,y:i-270,width:40,height:40,backgroundColor:9109504,hoverColor:10824234,text:"<-",fontFamily:'"Press Start 2P"',fontSize:"16px",onClick:()=>{this.scene.stop("TutorialScene"),this.scene.stop("MapScene"),this.scene.stop("UIScene"),this.scene.start("MenuScene")}});let g=this.add.sprite(t,i,"firefighter").setOrigin(.5).setScale(4).setX(t+100).setY(i+100),m=this.add.sprite(t,i,"dialog").setOrigin(.5).setScale(5).setX(t).setY(i),f=["According to the Incident Command System,\n there is a Type 1 wildfire in Oregon.","The fire is HUGE.\n\n Apparently, it was caused by a lightning strike.","I'm sending you with the highest level of coordination and resources we have.","But first, I need to show you how everything works.","The vertical bar on the right lists the available assets.","It looks like you have 10 firefighters, 5 fire extinguishers ...","...3 helicopters, 3 firetrucks, 2 airtankers, 1 hotshot crew...","...and 5 smokejumpers. Let's start fighting this fire!","Click the green Start button at the top of the screen.","The fire is spreading!","Click on the firefighter square, then deploy it by selecting a burning tile.","Fantastic! Click the firefighter square again to deactivate it.","Notice the flammability and fuel levels in the box in the top left corner.","Fuel is what feeds the fire and keeps it burning.","When the fuel runs out, the terrain becomes burnt.","Flammability is how fast the terrain is likely to catch fire.","Your job is to save as many houses and terrain tiles as possible.","Let's deploy some more assets. This fire is growing fast.","Try to deploy 3 helicopters.","Oh! Looks like there is a cooldown. Use fire extinguishers while you wait.","Alternate between different resources to fight as many flames as you can.","Uh oh! You ran out! Click the shop icon in the bottom right corner.","Here, you can purchase more assets! Click any of the green plus signs.","This controls the number of assets you want to buy.","Believe it or not, you actually earned some coins already!","Every time you put out a fire, you earn coins.","When you're ready, click Purchase.","Let's go fight more fires!"],x=this.add.rectangle(t,i,s-120,n-70,"0x9ff86f",0).setX(t-50).setY(i-30).setStrokeStyle(5,16777215,0).setOrigin(.5).setAlpha(.5),S=this.add.text(t,i-200,"Welcome to the crew, Rookie! We need your help.",{fontFamily:'"Press Start 2P"',fontSize:"20px",color:"#000000",wordWrap:{width:300,useAdvancedWrap:!0},align:"center"}).setOrigin(.5).setX(t).setY(i),b=0,y=!1;x.alwaysEnabled=!1,this.input.on("pointerdown",(e=>{x.getBounds().contains(e.x,e.y)&&(console.log(`D_COUNT: ${b}`),S.setText(f[b]),!1===y&&(b+=1),b>=13&&b<=18?this.scene.pause("MapScene"):this.scene.resume("MapScene"),22!==b&&28!=b||(m.setVisible(!1),S.setVisible(!1),b-=1,y=!0),b>=5&&(u.setAlpha(0),g.x=t-230,g.y=i+120,g.flipX=!0,g.setScale(2),m.x=t-180,m.y=i+50,m.flipX=!0,m.setScale(3),S.setFontSize("14px"),S.setStyle({wordWrap:{width:200,useAdvancedWrap:!0}}),S.x=t-170,S.y=i+55),b<27&&(0!==r&&0!==a&&0!==l&&0!==h&&0!==c&&0!==d&&0!==p||(this.scene.pause("MapScene"),m.setVisible(!0),S.setVisible(!0),!0===y&&(b+=1),y=!1)))}))}}class v{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s,this.left=null,this.right=null}isLeaf(){return null===this.left&&null===this.right}}const M=class{constructor(e,t,i){this.root=new v(0,0,e,t),this.minPartitionSize=i}partition(e=this.root){if(!e.isLeaf())return!1;if(e.width<=this.minPartitionSize||e.height<=this.minPartitionSize)return!1;let t=Math.random()>.5;e.width>e.height&&e.width/e.height>=1.25?t=!1:e.height>e.width&&e.height/e.width>=1.25&&(t=!0);const i=(t?e.height:e.width)-this.minPartitionSize;if(i<=this.minPartitionSize)return!1;const s=Math.floor(Math.random()*(i-this.minPartitionSize+1)+this.minPartitionSize),n=(t?e.height:e.width)-s;return!(s<this.minPartitionSize||n<this.minPartitionSize||(t?(e.left=new v(e.x,e.y,e.width,s),e.right=new v(e.x,e.y+s,e.width,e.height-s)):(e.left=new v(e.x,e.y,s,e.height),e.right=new v(e.x+s,e.y,e.width-s,e.height)),console.log(`Partitioned node at (${e.x}, ${e.y}, ${e.width}, ${e.height})`),console.log(`Left: (${e.left.x}, ${e.left.y}, ${e.left.width}, ${e.left.height})`),console.log(`Right: (${e.right.x}, ${e.right.y}, ${e.right.width}, ${e.right.height})`),0))}partitionAll(e=this.root){this.partition(e)&&(this.partitionAll(e.left),this.partitionAll(e.right))}getPartitions(e=this.root,t=[]){return e.isLeaf()?t.push(e):(e.left&&this.getPartitions(e.left,t),e.right&&this.getPartitions(e.right,t)),t}visualizePartitions(){const e=this.getPartitions();console.log("Visualizing Partitions:"),e.forEach(((e,t)=>{console.log(`Partition ${t+1}: (${e.x}, ${e.y}, ${e.width}, ${e.height})`)}))}};class E{static FLAM_GRASS=.8;static FUEL_GRASS=2;static FLAM_SHRUB=2.5;static FUEL_SHRUB=4;static FLAM_TREE=.3;static FUEL_TREE=6;static FLAM_WATER=0;static FUEL_WATER=0;static FLAM_GRASS_HOUSE=7;static FUEL_GRASS_HOUSE=4;static FLAM_SAND_HOUSE=3;static FUEL_SAND_HOUSE=6;static FLAM_DIRT_HOUSE=5;static FUEL_DIRT_HOUSE=4;constructor(e,t,i){this.x=e,this.y=t,this.terrain=i,this.burnStatus="unburned",this._crownFired=!1;const s=this.getTerrainAttributes(i);this.flammability=s.flammability,this.fuel=s.fuel,this.initialFuel=this.fuel}getTerrainAttributes(e){return{grass:{flammability:E.FLAM_GRASS,fuel:E.FUEL_GRASS},shrub:{flammability:E.FLAM_SHRUB,fuel:E.FUEL_SHRUB},tree:{flammability:E.FLAM_TREE,fuel:E.FUEL_TREE},water:{flammability:E.FLAM_WATER,fuel:E.FUEL_WATER},"grass-house":{flammability:E.FLAM_GRASS_HOUSE,fuel:E.FUEL_GRASS_HOUSE},"sand-house":{flammability:E.FLAM_SAND_HOUSE,fuel:E.FUEL_SAND_HOUSE},"dirt-house":{flammability:E.FLAM_DIRT_HOUSE,fuel:E.FUEL_DIRT_HOUSE}}[e]||{flammability:0,fuel:0}}toString(){return`{ x: ${this.x}, y: ${this.y}, terrain: '${this.terrain}', flammability: ${this.flammability}, fuel: ${this.fuel}, burnStatus: '${this.burnStatus}' }`}}const O=16,_=256,A=4095;let D;function V(e){const t=(()=>{const e=4294967296;let t,i;return{setSeed:s=>{i=t=(void 0===s?Math.random()*e:s)>>>0},getSeed:()=>t,rand:()=>(i=(1664525*i+1013904223)%e)/e}})();t.setSeed(e),D=new Array(4096);for(let e=0;e<4096;e++)D[e]=t.rand()}function R(e){return e*e*e*(e*(6*e-15)+10)}function $(e,t,i){return(1-i)*e+i*t}const L={seed:V,perlin2:function(e,t){void 0===D&&V(Math.random());const i=Math.floor(e),s=Math.floor(t),n=t-s,o=R(e-i),r=R(n),a=$(D[(i&A)+(s&A)*O],D[(i+1&A)+(s&A)*O],o),l=$(D[(i&A)+(s+1&A)*O],D[(i+1&A)+(s+1&A)*O],o);return $(a,l,r)},perlin3:function(e,t,i){void 0===D&&V(Math.random());const s=Math.floor(e),n=Math.floor(t),o=Math.floor(i),r=t-n,a=i-o,l=R(e-s),h=R(r),c=(R(a),$(D[(s&A)+(n&A)*O+(o&A)*_],D[(s+1&A)+(n&A)*O+(o&A)*_],l)),d=$(D[(s&A)+(n+1&A)*O+(o&A)*_],D[(s+1&A)+(n+1&A)*O+(o&A)*_],l);return $(c,d,h)}};class N{constructor(e,t,i=5,s=Math.random()){this.width=e,this.height=t,this.scale=i;const n="string"==typeof s?this.stringToNumber(s):s;L.seed(n),this.noiseGrid=this.generateNoiseGrid()}stringToNumber(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return Math.abs(t)/1e3}generateNoiseGrid(){const e=[];for(let t=0;t<this.height;t++){const i=[];for(let e=0;e<this.width;e++){const s=L.perlin2(e/this.scale,t/this.scale);i.push(s)}e.push(i)}return e}setSeed(e){const t="string"==typeof e?this.stringToNumber(e):e;L.seed(t),this.noiseGrid=this.generateNoiseGrid()}getNoise(e,t){if(e>=this.width||t>=this.height||e<0||t<0)throw new RangeError("Coordinates out of bounds");return this.noiseGrid[t][e]}}class U{static apply(e){const t=JSON.parse(JSON.stringify(e));for(let i=1;i<e.length-1;i++)for(let s=1;s<e[0].length-1;s++){const n=this.getNeighborCounts(e,s,i);e[i][s].terrain.includes("house")||(n.tree>4?t[i][s].terrain="tree":n.grass>5?t[i][s].terrain="grass":n.water>5&&(t[i][s].terrain="water"))}return this.seedAndGrowNeighborhoods(t),this.createNeighborhoods(t),t}static seedAndGrowNeighborhoods(e){let t=0;for(let i=0;i<5&&t<50;i++){let i=!1;for(;!i&&t<50;){const s=Math.floor(Math.random()*e[0].length),n=Math.floor(Math.random()*e.length),o=e[n][s],r=this.getNeighborCounts(e,s,n);if("grass"===o.terrain&&0===r.water){const t=6+Math.floor(5*Math.random());this.growNeighborhood(e,s,n,t),i=!0}t++}}}static growNeighborhood(e,t,i,s){const n=[{x:t,y:i}],o=new Set;let r=0;const a=(e,t)=>`${e},${t}`;for(;n.length>0&&r<s;){const{x:t,y:i}=n.shift();if(t>=0&&i>=0&&i<e.length&&t<e[0].length&&"grass"===e[i][t].terrain&&!o.has(a(t,i))){e[i][t].terrain="grass-house",o.add(a(t,i)),r++;const s=this.shuffle([{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}]);for(const{dx:e,dy:r}of s){const s=t+e,l=i+r;o.has(a(s,l))||n.push({x:s,y:l})}}}}static shuffle(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}static createNeighborhoods(e){const t=[];for(let i=0;i<e.length;i++)for(let s=0;s<e[0].length;s++)e[i][s].terrain.includes("house")&&t.push({x:s,y:i,tile:e[i][s]});this.clusterHouses(t).forEach((t=>{this.enhanceNeighborhood(e,t)}))}static clusterHouses(e){if(0===e.length)return[];const t=[],i=new Set;return e.forEach(((s,n)=>{if(i.has(n))return;const o=[s];i.add(n),e.forEach(((e,t)=>{n===t||i.has(t)||Math.sqrt(Math.pow(s.x-e.x,2)+Math.pow(s.y-e.y,2))<=5&&(o.push(e),i.add(t))})),t.push(o)})),t}static enhanceNeighborhood(e,t){if(!(t.length<=1)){for(let i=0;i<t.length-1;i++)this.createPath(e,t[i],t[i+1]);t.forEach((t=>{this.addLandscaping(e,t)}))}}static createPath(e,t,i){let[s,n]=[t.x,t.y],[o,r]=[i.x,i.y];const a=Math.abs(o-s),l=Math.abs(r-n),h=s<o?1:-1,c=n<r?1:-1;let d=a-l;for(;;){if(!(s===t.x&&n===t.y||s===i.x&&n===i.y)&&n>=0&&n<e.length&&s>=0&&s<e[n].length){const t=e[n][s];t&&"water"!==t.terrain&&!t.terrain.includes("house")&&Math.random()<.7&&(t.terrain="grass")}if(s===o&&n===r)break;const p=2*d;p>-l&&(d-=l,s+=h),p<a&&(d+=a,n+=c)}}static addLandscaping(e,t){for(let i=t.y-2;i<=t.y+2;i++)for(let s=t.x-2;s<=t.x+2;s++)if((s!==t.x||i!==t.y)&&i>=0&&i<e.length&&s>=0&&s<e[i].length){const t=e[i][s];t&&"water"!==t.terrain&&!t.terrain.includes("house")&&Math.random()<.6&&(t.terrain="grass")}}static getNeighborCounts(e,t,i){const s={tree:0,grass:0,shrub:0,water:0,"dirt-house":0,"grass-house":0,"sand-house":0};return[e[i-1]?.[t-1],e[i-1]?.[t],e[i-1]?.[t+1],e[i]?.[t-1],e[i]?.[t+1],e[i+1]?.[t-1],e[i+1]?.[t],e[i+1]?.[t+1]].forEach((e=>{e&&(void 0!==s[e.terrain]?s[e.terrain]++:s[e.terrain]=1)})),s}}class W{constructor(e,t,i,s=Date.now()+Math.random()){this.width=e,this.height=t,this.minSize=i,this.perlin=new N(e,t,5,s),this.bsp=new M(e,t,i),this.bsp.visualizePartitions(),this.grid=this.generateMap()}regenerateMap(e){this.perlin.setSeed(e),this.grid=this.generateMap()}generateMap(e){const t=Array.from({length:this.height},(()=>Array(this.width).fill(null))),i=this.bsp.getPartitions();0===i.length&&(console.error("BSPPartition failed to create any partitions. Falling back to single-partition grid."),i.push({x:0,y:0,width:this.width,height:this.height})),i.forEach((e=>{for(let i=e.y;i<e.y+e.height;i++)for(let s=e.x;s<e.x+e.width;s++){const e=this.perlin.getNoise(s,i),n=this.getTerrainFromNoise(e);t[i][s]=new E(s,i,n)}}));let s=0,n=0;for(let e=0;e<200;e++)s=Math.floor(98*Math.random()+1),n=Math.floor(98*Math.random()+1),"shrub"===t[n][s].terrain?t[n][s]=new E(s,n,"sand-house"):"tree"===t[n][s].terrain?t[n][s]=new E(s,n,"dirt-house"):"grass"===t[n][s].terrain?t[n][s]=new E(s,n,"grass-house"):"water"===t[n][s].terrain&&--e;return U.apply(t)}getTerrainFromNoise(e){let t="shrub";return e<.2?t="water":e<.4?t="tree":e<.7&&(t="grass"),t}printMap(){this.grid.forEach((e=>{console.log(e.map((e=>e.terrain)).join(" | "))}))}printBurnStatusMap(){this.grid.forEach((e=>{console.log(e.map((e=>e.burnStatus)).join(" | "))}))}getTile(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height?this.grid[t][e]:null}}const z=class{constructor(e,t){this.map=e,this.weather=t,console.log("Map object received: ",this.map),console.log("Weather object received:",this.weather)}simulateFireStep(){const e=[];for(let t=0;t<this.map.height;t++)for(let i=0;i<this.map.width;i++){const s=this.map.grid[t][i];"burning"===s.burnStatus&&e.push({tile:s,x:i,y:t})}if(0===e.length)return 0;let t=0;return e.forEach((({tile:e,x:i,y:s})=>{t+=this.processBurningTile(e,this.map.grid,i,s)})),e.length}copyGrid(){return this.map.grid.map((e=>e.map((e=>new E(e.x,e.y,e.terrain)))))}updateSprite(e,t){let i;if("object"==typeof e)i=e;else{if(!(this.map&&this.map.grid&&t>=0&&t<this.map.grid.length&&e>=0&&e<this.map.grid[t].length))return void console.warn("FireSpread: Invalid coordinates for updateSprite");i=this.map.grid[t][e]}if(i&&i.sprite&&i.sprite.scene&&i.sprite.scene.sys)try{i.sprite.setTexture(i.terrain)}catch(e){console.warn("FireSpread: Error updating tile sprite texture",e)}}processBurningTile(e,t,i,s){let n=this.spreadFire(e,i,s,t),o=t[s][i];return e.fuel=Math.max(0,o.fuel-1),0===e.fuel&&(e.burnStatus="burnt",e.fireS&&(e.fireS.extinguishFire(),"grass"===e.terrain?e.terrain="burned-grass":"shrub"===e.terrain?e.terrain="burned-shrub":"tree"===e.terrain?e.terrain="burned-tree":"grass-house"===e.terrain?e.terrain="burned-grass-house":"sand-house"===e.terrain?e.terrain="burned-sand-house":"dirt-house"===e.terrain&&(e.terrain="burned-dirt-house"),this.updateSprite(i,s)),this.updateSprite(i,s)),n}spreadFire(e,t,i,s){const n=this.getNeighbors(t,i);let o=0,r=0;"tree"===e.terrain&&(r=30);for(const e of n){const n=s[e.y][e.x];if("unburned"===n.burnStatus&&this.canIgnite(n)){const s=this.isTileDownwind({x:t,y:i},e);o+=this.attemptIgnite(n,s,r)}}return o}isTileDownwind(e,t){const i=this.weather.windDirection;return"N"===i&&t.y>e.y||"S"===i&&t.y<e.y||"E"===i&&t.x<e.x||"W"===i&&t.x>e.x}canIgnite(e){return"unburned"===e.burnStatus&&e.flammability>0}attemptIgnite(e,t,i=0){if("unburned"!==e.burnStatus||e.flammability<=0)return 0;if("grass"===e.terrain)return e.burnStatus="burning",1;let s=this.calculateIgnitionChance(e);return s*=.25,t&&(s+=.7*this.weather.windSpeed),s+=i,s*={low:.5,medium:1,high:1.5}[this.weather.getRiskCategory()],100*Math.random()<s?(e.burnStatus="burning",1):0}getNeighbors(e,t){return[{x:-1,y:0},{x:1,y:0},{x:0,y:-1},{x:0,y:1}].map((i=>({x:e+i.x,y:t+i.y}))).filter((e=>e.x>=0&&e.x<this.map.width&&e.y>=0&&e.y<this.map.height))}calculateIgnitionChance(e){let t=100*e.flammability+this.getWeatherInfluenceFromWeather();return"tree"===e.terrain&&(t*=.9),t}getWeatherInfluenceFromWeather(){return this.weather.getWeatherInfluence()}},H=class{constructor(e=68,t=70,i=0,s="N"){this.temperature=e,this.humidity=t,this.windSpeed=i,this.windDirection=s,this.ageHours=0}updateOverTime(e){this.temperature=50+20*Math.sin(2*Math.PI*(this.ageHours/24)),this.humidity=80-.5*(this.temperature-32),this.windSpeed=Phaser.Math.Clamp(this.windSpeed+Phaser.Math.FloatBetween(-2,2),0,50),Math.random()<.01&&(this.windDirection=["N","S","E","W"][Phaser.Math.Between(0,3)]),this.ageHours+=e/3600}getRiskCategory(){const e=this.getWeatherInfluence();return e<3?"low":e<7?"medium":"high"}getWeatherInfluence(e=null){let t=0;return t+=.1*(this.temperature-32),t-=.02*this.humidity,t+=.5*this.windSpeed,t+=1.5,e&&e===this.windDirection&&(t+=.7*this.windSpeed),parseFloat(t.toFixed(2))}};let B,Z,G,j,X,Y,K,J,q,Q,ee,te,ie,se,ne,oe,re=0,ae=!0,le=0,he=0,ce=0,de=0,pe=0,ue=0,ge=0,me=0;let fe,xe,Se,be,ye,Te,we,Fe,Ce,Ie,Pe=[];function ke(e,t){return e.setStyle({fontFamily:'"Press Start 2P"',fontSize:"10px",color:"#FFFFFF",backgroundColor:"#333333",padding:{x:6,y:4}}),t.add.rectangle(e.x,e.y,e.width+12,e.height+8,3355443,.7).setOrigin(.5).setDepth(e.depth-1)}let ve="",Me="none",Ee="cursor",Oe=null,_e=[0,0,0,0,0,0,0],Ae=0;const De={hose:100,extinguisher:50,helicopter:300,firetruck:200,airtanker:500,"hotshot-crew":300,smokejumper:1e3};function Ve(){return Ae}function Re(e){return Ae-=e,!(Ae<0&&(Ae+=e,1))}function $e(e){for(let t=0;t<=6;t++){let i=e[t];`${Me}`===i.name&&(i.setTexture(i.name),ve="NO-WATER",Me="none")}}function Le(e,t,i,s=1){if(e.fuel=Math.max(0,e.fuel-s),0===e.fuel){Ae+=De[Me]||0,J.setText(`${Ae}`),i.events.emit("extinguishFire",t)}}function Ne(e,t,i,s){if(e&&e.sprite&&"extinguished"!==e.burnStatus&&"burnt"!==e.burnStatus){if("burning"===e.burnStatus){Ae+=De[Me]||0,J.setText(`${Ae}`),s.events.emit("extinguishFire",e.sprite)}"not-burnt"===e.burnStatus?(e.terrain="fire-break",s.fireSpread.updateSprite(t,i)):(e.burnStatus="extinguished",e.terrain.includes("grass")||"grass"===e.terrain?e.terrain="extinguished-grass":e.terrain.includes("shrub")||"shrub"===e.terrain?e.terrain="extinguished-shrub":(e.terrain.includes("tree")||"tree"===e.terrain)&&(e.terrain="extinguished-tree"),s.fireSpread.updateSprite(t,i))}}function Ue(e,t,i,s,n,o,r,a){console.log(`Resource Activated: ${i}`),t.setInteractive(),t.on("pointerdown",(function(e,l,h,c){"none"!==Me||Qe?Me!==i||Qe?Qe||($e(Pe),t.setTexture("active-"+i),a.input.setDefaultCursor("url("+s+"), pointer"),ve=o,Me=`${i}`,Ee="deployment"):($e(Pe),t.setTexture(i),ve=r,a.input.setDefaultCursor("url("+n+"), pointer"),Ee="cursor"):(t.setTexture("active-"+i),a.input.setDefaultCursor("url("+s+"), pointer"),ve=o,Me=`${i}`,Ee="deployment")}),this)}function We(e,t,i,s,n){let o=n.add.sprite(i,s,t);o.setVisible(!1),e.on("pointerover",(function(){o.setVisible(!0)})),e.on("pointerout",(function(){o.setVisible(!1)}))}function ze(e,t,i=null){t?.setText&&null===i?(t.setText(i).setVisible(!0),e.time.delayedCall(2e3,(()=>t.setVisible(!1)))):"string"==typeof t?(e.fallbackNotificationText||(e.fallbackNotificationText=e.add.text(e.scale.width/2,e.scale.height-160,"",{fontFamily:'"Press Start 2P"',fontSize:"10px",color:"#ff5555",backgroundColor:"#000000",padding:{x:10,y:4}}).setOrigin(.5).setDepth(999).setScrollFactor(0).setVisible(!1)),e.fallbackNotificationText.setText(t).setVisible(!0),e.time.delayedCall(2e3,(()=>e.fallbackNotificationText.setVisible(!1)))):(t.setVisible(!0),e.time.delayedCall(1e3,(()=>{t.setVisible(!1)})))}function He(e,t,i,s,n=null){if("hose"===Me){if(u()<=0)return void ze(e,Q);if(_e[0]>0)return void ze(e,q)}else if("extinguisher"===Me){if(m()<=0)return void ze(e,ee);if(_e[1]>0)return void ze(e,q)}else if("helicopter"===Me){if(x()<=0)return void ze(e,te);if(_e[2]>0)return void ze(e,q)}else if("firetruck"===Me){if(b()<=0)return void ze(e,ie);if(_e[3]>0)return void ze(e,q)}if(!n&&("airtanker"===Me||"hotshot-crew"===Me))return Oe={scene:e,x:t,y:i,fireSprite:s},void e.scene.get("UIScene").directionPromptContainer.setVisible(!0);if("airtanker"===Me){if(T()<=0)return void ze(e,se);if(_e[4]>0)return void ze(e,q)}else if("hotshot-crew"===Me){if(F()<=0)return void ze(e,ne);if(_e[5]>0)return void ze(e,q)}else if("smokejumper"===Me){if(I()<=0)return void ze(e,oe);if(_e[6]>0)return void ze(e,q)}let o=new qe(3);if("hose"!==Me||Qe)if("extinguisher"!==Me||Qe)if("helicopter"!==Me||Qe)if("firetruck"!==Me||Qe)if("airtanker"!==Me||Qe)if("hotshot-crew"===Me){const s=e.scene.get("MapScene"),o=Math.floor(t/s.TILE_SIZE),r=Math.floor(i/s.TILE_SIZE),a=s.map.grid[r][o];if("unburned"!==a.burnStatus)return void ze(e,"Hotshots can only deploy on unburned tiles!");const l=new qe(3);l.useHotshotCrew(e,t,i),C(-1),l.startTimer(5,e,3e3,750,450),e.time.delayedCall(Ye,(()=>{const e="vertical"===(n||dropDirection)?[[0,-2],[0,-1],[0,1],[0,2]]:[[-2,0],[-1,0],[1,0],[2,0]];"burnt"!==a.burnStatus&&(a.burnStatus="not-burnt",Ne(a,o,r,s)),e.forEach((([e,t])=>{const i=o+e,n=r+t;if(i>=0&&i<s.map.width&&n>=0&&n<s.map.height){const e=s.map.grid[n][i];"burnt"!==e.burnStatus&&(e.burnStatus="not-burnt",Ne(e,i,n,s))}})),J.setText(`${Ae}`)}))}else"smokejumper"!==Me||Qe||(P(-1),o.useSmokejumpers(e,t,i,s),o.startTimer(6,e,750,530),e.time.delayedCall(Ke+Je,(()=>{e.events.emit("extinguishFire",s),J.setText(`${Ae}`)})));else w(-1),o.useAirtanker(e,t,i,s),o.startTimer(4,e,1e4,750,370),e.time.delayedCall(Xe,(()=>{const s=e.scene.get("MapScene"),o=Math.floor(t/s.TILE_SIZE),r=Math.floor(i/s.TILE_SIZE);("vertical"===(n||dropDirection)?[[0,-2],[0,-1],[0,0],[0,1],[0,2]]:[[-2,0],[-1,0],[0,0],[1,0],[2,0]]).forEach((([e,t])=>{const i=o+e,n=r+t;if(i>=0&&i<s.map.width&&n>=0&&n<s.map.height){const e=s.map.grid[n][i];"burnt"!==e.burnStatus&&Ne(e,i,n,s)}})),J.setText(`${Ae}`)}));else y(-1),o.useFiretruck(e,t,i,s),o.startTimer(3,e,5e3,750,290),e.time.delayedCall(Ge,(()=>{const t=e.scene.get("MapScene"),i=Math.floor(s.x/t.TILE_SIZE),n=Math.floor(s.y/t.TILE_SIZE);Le(t.map.grid[n][i],s,t,3),J.setText(`${Ae}`)}));else S(-1),o.useHelicopter(e,t,i,s),o.startTimer(2,e,7e3,750,210),e.time.delayedCall(je,(()=>{const t=e.scene.get("MapScene"),i=t.TILE_SIZE,n=Math.floor(s.x/i),o=Math.floor(s.y/i);[[0,0],[0,-1],[0,1],[1,0],[-1,0]].forEach((([e,i])=>{const s=n+e,r=o+i;s>=0&&s<t.map.width&&r>=0&&r<t.map.height&&Ne(t.map.grid[r][s],s,r,t)})),J.setText(`${Ae}`)}));else f(-1),o.useFireExtinguisher(e,t,i,s),o.startTimer(1,e,500,750,130),e.time.delayedCall(Ze,(()=>{const t=e.scene.get("MapScene"),i=Math.floor(s.x/t.TILE_SIZE),n=Math.floor(s.y/t.TILE_SIZE);Le(t.map.grid[n][i],s,t),J.setText(`${Ae}`)}));else g(-1),o.useHose(e,t,i,s),o.startTimer(0,e,3e3,750,50),e.time.delayedCall(Be,(()=>{const t=e.scene.get("MapScene"),i=Math.floor(s.x/t.TILE_SIZE),n=Math.floor(s.y/t.TILE_SIZE);Le(t.map.grid[n][i],s,t,2),J.setText(`${Ae}`)}))}let Be=4e3,Ze=3e3,Ge=3e3,je=3500,Xe=1700,Ye=3e3,Ke=2e3,Je=3e3;class qe{constructor(e){this.energy=e,this.sprite}lightFire(e,t,i){console.log("Attempting to light fire..."),e.anims.exists("fireAnimConfig")?console.log("Fire animation already exists."):(console.log("Creating fire animation..."),e.anims.create({key:"fireAnimConfig",frames:e.anims.generateFrameNumbers("fire-blaze",{start:0,end:5}),frameRate:10,repeat:-1}));let s=e.add.sprite(t.x+32,t.y,"fire-blaze").setDepth(900).setScale(.75);console.log("Fire sprite created:",s),e.anims.exists("fireAnimConfig")?(console.log("Playing fire animation..."),s.play("fireAnimConfig")):console.error("ERROR: Animation 'fireAnimConfig' does not exist!"),i.add(s),s.tile=t,s.setInteractive(),s.on("pointerdown",(function(){"WATER"===ve&&He(e,s.x,s.y,s)})),this.sprite=s}extinguishFire(){this.sprite.destroy()}startTimer(e,t,i,s,n){console.log("Timer activated!"),_e[e]=1,t.anims.exists("set-timer")||t.anims.create({key:"timerAnimConfig",frames:t.anims.generateFrameNumbers("set-timer"),frameRate:30,repeat:-1}),Fe.x=s,Fe.y=n,Fe.setVisible(!0),Fe.play("timerAnimConfig"),t.time.delayedCall(i,(()=>{Fe.setVisible(!1),t.anims.remove("timerAnimConfig"),_e[e]=0})),console.log(`Cooldown in StartTimer: ${_e[e]}`)}useHose(e,t,i,s){console.log("Team of firefighters activated!"),e.anims.create({key:"hoseAnimConfig",frames:e.anims.generateFrameNumbers("set-hose"),frameRate:40,repeat:-1});let n=e.add.sprite(t+40,i+32,"set-hose").setDepth(1e3).setScale(1.5,1.5);n.play("hoseAnimConfig"),e.time.delayedCall(Be,(()=>{n.destroy()}))}useFireExtinguisher(e,t,i,s){console.log("Fire extinguisher activated!"),e.anims.create({key:"extinguisherAnimConfig",frames:e.anims.generateFrameNumbers("set-extinguisher"),frameRate:10,repeat:-1});let n=e.add.sprite(t,i+32,"set-extinguisher").setDepth(1e3).setScale(.75,.75);n.play("extinguisherAnimConfig"),e.time.delayedCall(Ze,(()=>{n.destroy()}))}useFiretruck(e,t,i,s){console.log("Fire truck activated!"),e.anims.create({key:"firetruckAnimConfig",frames:e.anims.generateFrameNumbers("set-firetruck"),frameRate:10,repeat:-1});let n=e.add.sprite(t+40,i+32,"set-firetruck").setDepth(1e3).setScale(1.3,1.3);n.play("firetruckAnimConfig"),e.time.delayedCall(Ge,(()=>{n.destroy()}))}useHelicopter(e,t,i,s){console.log("Helicopter activated!"),e.anims.create({key:"helicopterAnimConfig",frames:e.anims.generateFrameNumbers("set-helicopter"),frameRate:30,repeat:-1});let n=e.add.sprite(t,i-40,"set-helicopter").setDepth(1e3).setScale(1.5,1.5);n.play("helicopterAnimConfig"),e.time.delayedCall(je,(()=>{n.destroy()}))}useAirtanker(e,t,i,s){console.log("Airtanker activated!"),e.anims.create({key:"airtankerAnimConfig",frames:e.anims.generateFrameNumbers("set-airtanker"),frameRate:30,repeat:-1});let n=e.add.sprite(t,i-40,"set-airtanker").setDepth(1e3).setScale(4.5,4.5);n.play("airtankerAnimConfig"),e.time.delayedCall(Xe,(()=>{n.destroy()}))}useHotshotCrew(e,t,i){console.log("Hotshot Crew activated!"),e.anims.create({key:"hotshotAnimConfig",frames:e.anims.generateFrameNumbers("set-hotshot"),frameRate:30,repeat:-1});let s=e.add.sprite(t+40,i+28,"set-hotshot").setDepth(1e3).setScale(1.1,1.1);s.play("hotshotAnimConfig"),e.time.delayedCall(Ye,(()=>{s.destroy()}))}useSmokejumpers(e,t,i,s){console.log("Smokejumpers activated!"),e.anims.create({key:"smokejumpersAnimConfig",frames:e.anims.generateFrameNumbers("set-smokejumpers"),frameRate:30,repeat:-1}),e.anims.create({key:"smokejumpersGroundAnimConfig",frames:e.anims.generateFrameNumbers("set-smokejumpers-dig"),frameRate:30,repeat:-1});let n=e.add.sprite(t,i-40,"set-smokejumpers").setDepth(1e3).setScale(2,2);n.play("smokejumpersAnimConfig"),e.time.delayedCall(Ke,(()=>{n.destroy();let s=e.add.sprite(t,i,"set-smokejumpers-dig").setDepth(2).setScale(1,1);s.play("smokejumpersGroundAnimConfig"),e.time.delayedCall(Je,(()=>{s.destroy()}))}))}}let Qe=!0;class et extends Phaser.Scene{constructor(){super("MapScene"),console.log("MapScene Constructor Called"),this.MAP_WIDTH=100,this.MAP_HEIGHT=100,this.TILE_SIZE=64,this.MIN_PARTITION_SIZE=5,this.CAMERA_SPEED=10,this.MIN_ZOOM=.25,this.MAX_ZOOM=2,this.UI_WIDTH=100,this.FIRE_SPREAD_INTERVAL=12e3,this.elapsedTime=0,this.lastFireSpreadTime=0,this.isFireSimRunning=!1,this.selectedTile=null,this.lastTileSnapshot=null,this.tileInfoUpdateInterval=500,this.lastTileInfoUpdate=0,this.currentZoom=1,this.isPanning=!1,this.panVector={x:0,y:0},this.score=0}preload(){console.log("MapScene Preload Starting"),this.load.image("water","assets/64x64-Map-Tiles/water.png"),this.load.image("grass","assets/64x64-Map-Tiles/grass.png"),this.load.image("shrub","assets/64x64-Map-Tiles/Shrubs/shrubs-on-sand.png"),this.load.image("tree","assets/64x64-Map-Tiles/Trees/trees-on-light-dirt.png"),this.load.image("dirt-house","assets/64x64-Map-Tiles/dirt-house.png"),this.load.image("sand-house","assets/64x64-Map-Tiles/sand-house.png"),this.load.image("grass-house","assets/64x64-Map-Tiles/grass-house.png"),this.load.image("burned-grass","assets/64x64-Map-Tiles/Burned%20Tiles/burned-grass.png"),this.load.image("burned-shrub","assets/64x64-Map-Tiles/Burned%20Tiles/burned-shrubs-on-sand.png"),this.load.image("burned-tree","assets/64x64-Map-Tiles/Burned%20Tiles/burned-trees-on-light-dirt.png"),this.load.image("burned-dirt-house","assets/64x64-Map-Tiles/Burned%20Tiles/burned-dirt-house.png"),this.load.image("burned-sand-house","assets/64x64-Map-Tiles/Burned%20Tiles/burned-sand-house.png"),this.load.image("burned-grass-house","assets/64x64-Map-Tiles/Burned%20Tiles/burned-grass-house.png"),this.load.image("extinguished-grass","assets/64x64-Map-Tiles/Extinguished%20Tiles/grass.png"),this.load.image("extinguished-shrub","assets/64x64-Map-Tiles/Extinguished%20Tiles/shrub.png"),this.load.image("extinguished-tree","assets/64x64-Map-Tiles/Extinguished%20Tiles/tree.png"),this.load.image("extinguished-dirt-house","assets/64x64-Map-Tiles/Extinguished%20Tiles/dirt-house.png"),this.load.image("extinguished-sand-house","assets/64x64-Map-Tiles/Extinguished%20Tiles/sand-house.png"),this.load.image("extinguished-grass-house","assets/64x64-Map-Tiles/Extinguished%20Tiles/grass-house.png"),this.load.image("fire-break","assets/64x64-Map-Tiles/fire-break.png"),this.load.spritesheet("water-sheet","assets/64x64-Map-Tiles/splash-sheet.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet("fire-blaze","assets/64x64-Map-Tiles/animated-flame.png",{frameWidth:64,frameHeight:64})}create(){console.log("MapScene Create Starting"),this.input.mouse.disableContextMenu(),this.initializeMap(),this.setupCameraControls(),this.scene.isActive("UIScene")||this.scene.launch("UIScene"),this.scene.get("UIScene").events.on("directionChosen",(e=>{if(null===e)return Oe=null,void console.log("Deployment canceled by user.");if(!Oe)return;const{scene:t,x:i,y:s,fireSprite:n}=Oe;Oe=null,He(t,i,s,n,e)})),this.input.on("pointerdown",this.handleTileClick,this),this.setupEventListeners(),this.events.on("extinguishFire",this.handleFireExtinguish,this),this.selectionMarker=this.add.graphics(),this.selectionMarker.lineStyle(3,65535,1),this.selectionMarker.strokeRect(0,0,this.TILE_SIZE,this.TILE_SIZE),this.selectionMarker.setVisible(!1),this.selectionMarker.setDepth(100),console.log("MapScene Create Finished")}setupEventListeners(){console.log("Setting up MapScene event listeners"),this.scene.get("UIScene").events.on("toggleFire",this.toggleFireSimulation,this),this.scene.get("UIScene").events.on("restartGame",this.initializeMap,this);const e=this.scene.get("UIScene");e.events.on("panStart",this.onPanStart,this),e.events.on("panStop",this.onPanStop,this)}setupCameraControls(){const e=this.cameras.main.width-this.UI_WIDTH,t=this.cameras.main.height,i=this.mapPixelWidth/this.mapPixelHeight,s=e/t;this.fitZoomLevel=i>s?Math.min(1,e/this.mapPixelWidth):Math.min(1,t/this.mapPixelHeight),this.MIN_ZOOM=Math.max(.8*this.fitZoomLevel,this.MIN_ZOOM),this.cameras.main.setBounds(0,0,this.mapPixelWidth,this.mapPixelHeight),this.cameras.main.setViewport(0,0,this.cameras.main.width,this.cameras.main.height),this.cameras.main.centerOn(this.mapPixelWidth/2,this.mapPixelHeight/2),this.currentZoom=Math.max(this.MIN_ZOOM,1),this.cameras.main.setZoom(this.currentZoom),this.input.on("wheel",((t,i,s,n)=>{if(t.x<e){const e=n>0?-.1:.1;this.currentZoom=Phaser.Math.Clamp(this.currentZoom+e,this.MIN_ZOOM,this.MAX_ZOOM),this.cameras.main.setZoom(this.currentZoom),this.events.emit("zoomChanged",this.currentZoom),this.centerMapIfNeeded()}})),this.cursors=this.input.keyboard.createCursorKeys(),this.wasd={up:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),down:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),left:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),right:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D)},this.zoomKeys={zoomIn:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.PLUS),zoomOut:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.MINUS)}}centerMapIfNeeded(){const e=this.mapPixelWidth*this.currentZoom,t=this.mapPixelHeight*this.currentZoom,i=this.cameras.main.width,s=this.cameras.main.height;if(e<i||t<s){const e=this.mapPixelWidth/2,t=this.mapPixelHeight/2;this.cameras.main.pan(e,t,300,"Power2")}}initializeMap(){this.score=0;const e=this.currentZoom||1;this.mapPixelWidth=this.MAP_WIDTH*this.TILE_SIZE,this.mapPixelHeight=this.MAP_HEIGHT*this.TILE_SIZE,this.currentSeed=Date.now()*Math.random(),console.log(`Map Seed: ${this.currentSeed}`),this.map=new W(this.MAP_WIDTH,this.MAP_HEIGHT,this.MIN_PARTITION_SIZE,this.currentSeed),console.log("Map Partitions:"),this.map.bsp.getPartitions().forEach(((e,t)=>{console.log(`Partition ${t}: x=${e.x}, y=${e.y}, width=${e.width}, height=${e.height}`)})),this.weather=new H(this.MAP_WIDTH,this.MAP_HEIGHT),this.fireSpread=new z(this.map,this.weather),this.elapsedTime=0,this.lastFireSpreadTime=0,this.isFireSimRunning=!0,this.currentZoom=Math.max(e,this.MIN_ZOOM),this.mapGroup&&!this.mapGroup.destroyed&&this.mapGroup.destroy(!0),this.mapGroup=this.add.group(),this.flameGroup?this.flameGroup.clear(!0,!0):this.flameGroup=this.add.group(),this.cameras&&this.cameras.main&&(this.cameras.main.setBounds(0,0,this.mapPixelWidth,this.mapPixelHeight),this.cameras.main.centerOn(this.mapPixelWidth/2,this.mapPixelHeight/2),this.cameras.main.setZoom(this.currentZoom)),this.renderMap(this.map,this.TILE_SIZE),this.time.delayedCall(500,(()=>{console.log("Delayed fire start after map initialization"),this.startFire()||(console.warn("Initial fire start failed, retrying..."),this.time.delayedCall(1e3,(()=>this.startFire()))),this.time.delayedCall(1e3,(()=>{this.simulateInitialSpread(4),this.isFireSimRunning=!1,this.events.emit("fireSimToggled",this.isFireSimRunning)}))})),this.events.emit("weatherUpdated",this.weather),this.events.emit("updateGameClock",this.elapsedTime),this.events.emit("mapSizeChanged",{width:this.MAP_WIDTH,height:this.MAP_HEIGHT,pixelWidth:this.mapPixelWidth,pixelHeight:this.mapPixelHeight}),this.scene.isActive("UIScene")&&(Re(Ve()),J.setText(`${Ve()}`))}renderMap(e,t){e.grid.forEach(((e,i)=>{e.forEach(((e,s)=>{const n=this.textures.exists(e.terrain)?e.terrain:"defaultTerrain",o=this.add.sprite(s*t,i*t,n).setOrigin(0);e.sprite=o,o.setInteractive(),this.mapGroup.add(o)}))}))}handleTileClick(e){if(this.isPanning)return;const t=this.cameras.main.width-this.UI_WIDTH;if(e.x>t)return;const i=this.cameras.main.getWorldPoint(e.x,e.y),s=Math.floor(i.x/this.TILE_SIZE),n=Math.floor(i.y/this.TILE_SIZE);if(s<0||s>=this.map.width||n<0||n>=this.map.height)return;const o=this.map.getTile(s,n);if(o)if("deployment"!==Ee)this.selectedTile=o,this.selectionMarker.setVisible(!0).setPosition(s*this.TILE_SIZE,n*this.TILE_SIZE),this.lastTileInfoSnapshot={...o},this.events.emit("tileInfo",{...o,screenX:e.x,screenY:e.y});else if("hotshot-crew"===Me||"hotshotcrew"===Me)He(this,s*this.TILE_SIZE,n*this.TILE_SIZE,null);else{const e=o.fireSprite;if(!e)return;He(this,e.x,e.y,e)}}startFire(){if(console.log("Starting fire initialization..."),!this.map||!this.map.grid||0===this.map.grid.length)return console.error("Map not properly initialized when starting fire!"),void this.time.delayedCall(500,(()=>this.startFire()));let e,t,i,s=0,n=!1;for(console.log("Searching for flammable tile...");!n&&s<200;){if(e=Math.floor(Math.random()*this.map.width),t=Math.floor(Math.random()*this.map.height),t>=0&&t<this.map.grid.length&&e>=0&&e<this.map.grid[t].length)if(i=this.map.grid[t][e],i&&void 0!==i.flammability){if(i.flammability>0){n=!0,console.log(`Found flammable tile at (${e}, ${t}) after ${s} attempts`);break}}else console.warn("Found invalid tile at",e,t);s++}if(!n){console.log("Random search failed, trying systematic search...");for(let s=0;s<this.map.height;s++){for(let o=0;o<this.map.width;o++)if(s<this.map.grid.length&&o<this.map.grid[s].length){const r=this.map.grid[s][o];if(r&&r.terrain&&("tree"===r.terrain||"shrub"===r.terrain||"grass"===r.terrain||"dirt_house"===r.terrain||"sand_house"===r.terrain||"grass_house"===r.terrain)){e=o,t=s,i=r,0===i.flammability&&(console.log(`Forcing tile at (${o}, ${s}) to be flammable`),i.flammability=1,i.fuel=10),n=!0;break}}if(n)break}}if(!n||!i)return console.error("CRITICAL: Could not find any flammable tile after exhaustive search"),console.log("Map data:",this.map),void this.time.delayedCall(1e3,(()=>{console.log("Attempting fire start again after delay"),this.startFire()}));if(console.log(`Setting fire at (${e}, ${t}) with terrain: ${i.terrain}`),i.burnStatus="burning",i.sprite)try{let e=new qe(3);e.lightFire(this,i.sprite,this.flameGroup),i.fireS=e,console.log("Fire sprite added successfully")}catch(e){console.error("Failed to add fire sprite:",e)}else console.warn("Tile has no sprite to attach fire effect to");try{this.cameras.main.pan(e*this.TILE_SIZE+this.TILE_SIZE/2,t*this.TILE_SIZE+this.TILE_SIZE/2,1e3,"Power2"),console.log("Camera panned to fire location")}catch(e){console.error("Failed to pan camera:",e)}return!0}simulateInitialSpread(e=4){let t=[];for(let e=0;e<this.map.height;e++)for(let i=0;i<this.map.width;i++)"burning"===this.map.grid[e][i].burnStatus&&t.push({x:i,y:e});let i=new Set(t.map((e=>`${e.x},${e.y}`)));for(let s=0;s<e;s++){let e=[];t.forEach((({x:t,y:s})=>{this.fireSpread.getNeighbors(t,s).forEach((({x:t,y:s})=>{const n=this.map.grid[s][t],o=`${t},${s}`;if(!i.has(o)&&this.fireSpread.canIgnite(n)){if(n.burnStatus="burning",!n.fireS&&n.sprite){const e=new qe(3);e.lightFire(this,n.sprite,this.flameGroup),n.fireS=e}e.push({x:t,y:s}),i.add(o)}}))})),t=e}console.log("Simulated initial non-burning fire burst.")}updateFireSpread(){if(0===this.fireSpread.simulateFireStep())return console.log("You win!"),this.isFireSimRunning=!1,this.events.emit("gameWon"),void this.events.emit("fireSimToggled",!1);this.map.grid.forEach((e=>e.forEach((e=>{if("burning"===e.burnStatus&&!e.fireS){const t=new qe(3);t.lightFire(this,e.sprite,this.flameGroup),e.fireS=t}}))))}toggleFireSimulation(){console.log("Toggle fire simulation called"),this.isFireSimRunning=!this.isFireSimRunning,console.warn("Fire Simulation "+(this.isFireSimRunning?"Started":"Stopped")),Qe=!this.isFireSimRunning,this.events.emit("fireSimToggled",this.isFireSimRunning)}update(e,t){if(this.isFireSimRunning){this.elapsedTime+=t/1e3,this.events.emit("updateGameClock",this.elapsedTime);const e=this.elapsedTime-this.lastFireSpreadTime,i=this.FIRE_SPREAD_INTERVAL/1e3,s=e/i*100;this.scene.get("UIScene").updateFireProgress(s),e>=i&&(this.weather.updateOverTime(1e3*i),this.events.emit("weatherUpdated",this.weather),this.lastFireSpreadTime=this.elapsedTime,this.updateFireSpread())}if(this.handleCameraControls(t),this.flameGroup&&this.flameGroup.getChildren().length>0&&this.flameGroup.getChildren().forEach((e=>{e.setScale(1/this.currentZoom)})),this.selectedTile&&(this.lastTileInfoUpdate+=t,this.lastTileInfoUpdate>=this.tileInfoUpdateInterval)){this.lastTileInfoUpdate=0;const e={fuel:this.selectedTile.fuel,burnStatus:this.selectedTile.burnStatus,terrain:this.selectedTile.terrain};JSON.stringify(e)!==JSON.stringify(this.lastTileSnapshot)&&(this.events.emit("tileInfo",{...this.selectedTile,screenX:this.input.activePointer.x,screenY:this.input.activePointer.y}),this.lastTileSnapshot={...e})}}onPanStart(e){this.panVector=e}onPanStop(){this.panVector={x:0,y:0}}handleCameraControls(e){const t=this.CAMERA_SPEED/this.currentZoom;let i=(this.cursors.left.isDown||this.wasd.left.isDown?-t:0)+(this.cursors.right.isDown||this.wasd.right.isDown?t:0),s=(this.cursors.up.isDown||this.wasd.up.isDown?-t:0)+(this.cursors.down.isDown||this.wasd.down.isDown?t:0);0===i&&0===s||(this.cameras.main.scrollX+=i,this.cameras.main.scrollY+=s);let n=!1;this.zoomKeys.zoomIn.isDown?(this.currentZoom=Phaser.Math.Clamp(this.currentZoom+.01,this.MIN_ZOOM,this.MAX_ZOOM),this.cameras.main.setZoom(this.currentZoom),n=!0):this.zoomKeys.zoomOut.isDown&&(this.currentZoom=Phaser.Math.Clamp(this.currentZoom-.01,this.MIN_ZOOM,this.MAX_ZOOM),this.cameras.main.setZoom(this.currentZoom),n=!0),i+=this.panVector.x*t,s+=this.panVector.y*t,(i||s)&&(this.cameras.main.scrollX+=i,this.cameras.main.scrollY+=s),n&&(this.events.emit("zoomChanged",this.currentZoom),this.centerMapIfNeeded())}handleFireExtinguish(e){let t=Math.floor(e.x/this.TILE_SIZE),i=Math.floor(e.y/this.TILE_SIZE);if(t>=0&&t<this.map.width&&i>=0&&i<this.map.height){let e=this.map.grid[i][t];e&&(e.burnStatus="extinguished",this.score+=1,this.events.emit("scoreUpdated",this.score),console.log("Score: ",this.score),"grass"===e.terrain?e.terrain="extinguished-grass":e.terrain.includes("shrub")||"shrub"===e.terrain?e.terrain="extinguished-shrub":e.terrain.includes("tree")||"tree"===e.terrain?e.terrain="extinguished-tree":e.terrain.includes("dirt-house")||"dirt-house"===e.terrain?e.terrain="extinguished-dirt-house":e.terrain.includes("sand-house")||"sand-house"===e.terrain?e.terrain="extinguished-sand-house":(e.terrain.includes("grass-house")||"grass-house"===e.terrain)&&(e.terrain="extinguished-grass-house"),this.fireSpread.updateSprite(t,i),e.fireS&&(e.fireS.extinguishFire(),e.fireS=null))}}}class tt{constructor(e,t={}){this.scene=e,this.options={width:t.width||400,height:t.height||500,backgroundColor:t.backgroundColor||2962486,buttonColor:t.buttonColor||5592405,buttonHoverColor:t.buttonHoverColor||7829367,activeColor:t.activeColor||2263842,depth:t.depth||1e3,onSettingsApplied:t.onSettingsApplied||null},this.container=null,this.accessibilityToggles=[],this.isVisible=!1,this.init()}init(){this.container=this.scene.add.container(0,0).setDepth(this.options.depth).setVisible(!1);const e=this.scene.add.rectangle(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,this.options.width,this.options.height,this.options.backgroundColor,.95).setScrollFactor(0),t=this.scene.add.text(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2-220,"Accessibility Options",{fontFamily:'"Press Start 2P"',fontSize:"20px",color:"#ffffff",align:"center"}).setOrigin(.5).setScrollFactor(0),i=o(this.scene,{x:this.scene.cameras.main.width/2+170,y:this.scene.cameras.main.height/2-220,width:30,height:30,backgroundColor:9109504,hoverColor:10824234,text:"X",fontSize:"16px",onClick:()=>this.hide()});this.container.add([e,t,i.button,i.buttonText]);const s=this.scene.cameras.main.height/2-150;[{text:"High Contrast Mode",key:"highContrast"},{text:"Larger Text",key:"largerText"},{text:"Reduced Motion",key:"reducedMotion"},{text:"Screen Reader Support",key:"screenReader"},{text:"Colorblind Mode",key:"colorblind",isSelector:!0}].forEach(((e,t)=>{const i=s+60*t,n=this.scene.add.text(this.scene.cameras.main.width/2-150,i,e.text,{fontFamily:'"Press Start 2P"',fontSize:"14px",color:"#ffffff"}).setScrollFactor(0);if(this.container.add(n),e.isSelector){const t=o(this.scene,{x:this.scene.cameras.main.width/2+100,y:i,width:150,height:30,backgroundColor:this.options.buttonColor,hoverColor:this.options.buttonHoverColor,text:"Deuteranopia",fontSize:"10px",onClick:()=>this.cycleColorblindMode(t)});this.container.add([t.button,t.buttonText]),this.accessibilityToggles.push({key:e.key,element:t,value:"deuteranopia"})}else{const t=this.scene.add.rectangle(this.scene.cameras.main.width/2+100,i,50,26,this.options.buttonColor).setScrollFactor(0),s=this.scene.add.circle(this.scene.cameras.main.width/2+80,i,10,16777215).setScrollFactor(0);t.setInteractive().on("pointerdown",(()=>{const i=t.fillColor===this.options.activeColor;t.setFillStyle(i?this.options.buttonColor:this.options.activeColor),s.x=i?this.scene.cameras.main.width/2+80:this.scene.cameras.main.width/2+120,this.accessibilityToggles.find((t=>t.key===e.key)).value=!i})),this.container.add([t,s]),this.accessibilityToggles.push({key:e.key,element:{bg:t,circle:s},value:!1})}}));const n=o(this.scene,{x:this.scene.cameras.main.width/2,y:this.scene.cameras.main.height/2+200,width:150,height:40,backgroundColor:2263842,hoverColor:3050327,text:"Apply",fontSize:"16px",onClick:()=>this.applySettings()});this.container.add([n.button,n.buttonText]),this.loadSavedSettings()}loadSavedSettings(){try{const e=JSON.parse(localStorage.getItem("accessibilitySettings")||"{}");Object.entries(e).forEach((([e,t])=>{const i=this.accessibilityToggles.find((t=>t.key===e));if(i)if("colorblind"===e){const e=["Deuteranopia","Protanopia","Tritanopia","None"].find((e=>e.toLowerCase()===t))||"None";i.element.buttonText.setText(e),i.value=t}else i.element.bg.setFillStyle(t?this.options.activeColor:this.options.buttonColor),i.element.circle.x=t?this.scene.cameras.main.width/2+120:this.scene.cameras.main.width/2+80,i.value=t}))}catch(e){console.error("Error loading accessibility settings:",e)}}cycleColorblindMode(e){const t=["Deuteranopia","Protanopia","Tritanopia","None"],i=this.accessibilityToggles.find((e=>"colorblind"===e.key)),s=(t.findIndex((e=>e.toLowerCase()===i.value))+1)%t.length,n=t[s].toLowerCase();e.buttonText.setText(t[s]),i.value=n}applySettings(){try{const e={};this.accessibilityToggles.forEach((t=>{e[t.key]=t.value})),localStorage.setItem("accessibilitySettings",JSON.stringify(e))}catch(e){console.error("Error saving accessibility settings:",e)}this.accessibilityToggles.forEach((e=>{this.scene.events&&this.scene.events.emit(`set${e.key.charAt(0).toUpperCase()+e.key.slice(1)}`,e.value)})),this.options.onSettingsApplied&&this.options.onSettingsApplied(this.accessibilityToggles.reduce(((e,t)=>(e[t.key]=t.value,e)),{})),this.showConfirmation()}showConfirmation(){const e=this.scene.add.text(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2+150,"Settings Applied!",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#00ff00",align:"center"}).setOrigin(.5).setScrollFactor(0);this.container.add(e),this.scene.time.delayedCall(2e3,(()=>{e.destroy()}))}show(){this.container.setVisible(!0),this.isVisible=!0}hide(){this.container.setVisible(!1),this.isVisible=!1}toggle(){this.isVisible?this.hide():this.show()}getSettings(){return this.accessibilityToggles.reduce(((e,t)=>(e[t.key]=t.value,e)),{})}}class it{constructor(e,t={}){this.scene=e,this.options={x:t.x||40,y:t.y||30,width:t.width||250,backgroundColor:t.backgroundColor||2962486,buttonColor:t.buttonColor||5592405,buttonHoverColor:t.buttonHoverColor||7829367,iconColor:t.iconColor||16777215,depth:t.depth||1e3,openDirection:t.openDirection||"left",menuItems:t.menuItems||[{text:"Profile",key:"profile"},{text:"Leaderboard",key:"leaderboard"},{text:"Login/Logout",key:"login"}]},this.isOpen=!1,this.container=null,this.button=null,this.menuPanel=null,this.menuItems=[],this.accessibilityPanel=null,this.init()}init(){this.container=this.scene.add.container(0,0).setDepth(this.options.depth),this.createMenuButton(),this.createMenuPanel(),this.createAccessibilityPanel()}createMenuButton(){const e=this.scene.add.rectangle(this.options.x,this.options.y,40,40,this.options.buttonColor,.7).setInteractive().setScrollFactor(0).on("pointerover",(()=>{e.setFillStyle(this.options.buttonHoverColor,.8)})).on("pointerout",(()=>{e.setFillStyle(this.options.buttonColor,.7)})).on("pointerdown",(()=>{this.toggleMenu()})),t=this.options.x-10,i=this.options.y-8;this.iconLines=[this.scene.add.rectangle(t,i,20,3,this.options.iconColor).setScrollFactor(0),this.scene.add.rectangle(t,i+6,20,3,this.options.iconColor).setScrollFactor(0),this.scene.add.rectangle(t,i+12,20,3,this.options.iconColor).setScrollFactor(0)],this.container.add([e,...this.iconLines]),this.button=e}createMenuPanel(){this.menuPanel=this.scene.add.rectangle(-this.options.width/2,this.scene.cameras.main.height/2,this.options.width,this.scene.cameras.main.height,this.options.backgroundColor,.9).setScrollFactor(0).setVisible(!1),this.container.add(this.menuPanel),this.createMenuItems()}createMenuItems(){this.options.menuItems.forEach(((e,t)=>{const i=100+50*t,s=o(this.scene,{x:this.options.width/2,y:i,width:this.options.width-40,height:40,backgroundColor:this.options.buttonColor,hoverColor:this.options.buttonHoverColor,text:e.text,fontSize:"16px",onClick:()=>this.handleMenuItemClick(e.key)});s.button.setVisible(!1),s.buttonText.setVisible(!1),this.menuItems.push(s),this.container.add([s.button,s.buttonText])}))}createAccessibilityPanel(){this.accessibilityPanel=new tt(this.scene,{depth:this.options.depth+1,onSettingsApplied:e=>{console.log("Accessibility settings applied:",e)}})}handleMenuItemClick(e){switch(console.log(`Menu item clicked: ${e}`),e){case"accessibility":this.showAccessibilityPanel();break;case"profile":this.scene.scene&&this.scene.scene.launch("ProfileScene"),this.toggleMenu();break;case"leaderboard":this.scene.scene&&this.scene.scene.launch("LeaderboardScene"),this.toggleMenu();break;case"login":const e=window.firebase?.auth?.();e&&e.currentUser?this.showLogoutConfirmation():this.scene.scene&&this.scene.scene.start("LoginScene"),this.toggleMenu();break;default:this.toggleMenu()}}showAccessibilityPanel(){this.accessibilityPanel.show(),this.toggleMenu()}hideAccessibilityPanel(){this.accessibilityPanel.hide()}showLogoutConfirmation(){const e=this.scene.add.container(0,0).setDepth(this.options.depth+10),t=this.scene.add.rectangle(0,0,this.scene.cameras.main.width,this.scene.cameras.main.height,0,.7).setOrigin(0,0),i=this.scene.add.rectangle(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,400,250,2962486,.95).setStrokeStyle(3,5592405),s=this.scene.add.text(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2-80,"Confirm Logout",{fontFamily:'"Press Start 2P"',fontSize:"20px",color:"#ffffff",align:"center"}).setOrigin(.5),n=this.scene.add.text(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2-30,"Are you sure you want to logout?",{fontFamily:'"Press Start 2P"',fontSize:"14px",color:"#ffffff",align:"center",wordWrap:{width:350}}).setOrigin(.5),r=o(this.scene,{x:this.scene.cameras.main.width/2-100,y:this.scene.cameras.main.height/2+50,width:140,height:40,backgroundColor:9109504,hoverColor:10824234,text:"Logout",fontSize:"14px",onClick:()=>{const t=window.firebase?.auth?.();t&&t.signOut().then((()=>{console.log("User signed out"),this.scene.scene.start("LoginScene")})).catch((e=>{console.error("Error signing out:",e)})),e.destroy()}}),a=o(this.scene,{x:this.scene.cameras.main.width/2+100,y:this.scene.cameras.main.height/2+50,width:140,height:40,backgroundColor:5592405,hoverColor:7829367,text:"Cancel",fontSize:"14px",onClick:()=>{e.destroy()}});e.add([t,i,s,n,r.button,r.buttonText,a.button,a.buttonText]),t.setInteractive().on("pointerdown",(()=>{e.destroy()}))}toggleMenu(){this.isOpen=!this.isOpen,this.menuPanel.setVisible(this.isOpen),this.menuItems.forEach((e=>{e.button.setVisible(this.isOpen),e.buttonText.setVisible(this.isOpen)})),this.animateIcon(),this.animateMenuPanel()}animateIcon(){this.isOpen?(this.scene.tweens.add({targets:this.iconLines[0],y:this.options.y,rotation:Math.PI/4,duration:300,ease:"Power2"}),this.scene.tweens.add({targets:this.iconLines[1],alpha:0,duration:300,ease:"Power2"}),this.scene.tweens.add({targets:this.iconLines[2],y:this.options.y,rotation:-Math.PI/4,duration:300,ease:"Power2"})):(this.scene.tweens.add({targets:this.iconLines[0],y:this.options.y-8,rotation:0,duration:300,ease:"Power2"}),this.scene.tweens.add({targets:this.iconLines[1],alpha:1,duration:300,ease:"Power2"}),this.scene.tweens.add({targets:this.iconLines[2],y:this.options.y+4,rotation:0,duration:300,ease:"Power2"}))}animateMenuPanel(){this.isOpen?this.scene.tweens.add({targets:this.menuPanel,x:this.options.width/2,duration:300,ease:"Power2"}):this.scene.tweens.add({targets:this.menuPanel,x:-this.options.width/2,duration:300,ease:"Power2"})}}var st=i(371);"undefined"!=typeof window&&(window.WebFont=st);class nt extends s.Loader.File{constructor(e,t,i="google"){super(e,{type:"webfont",key:t.toString()}),this.fontNames=Array.isArray(t)?t:[t],this.service=i}load(){const e={active:()=>{this.loader.nextFile(this,!0)}};if("google"!==this.service)throw new Error("Unsupported font service: "+this.service);e.google={families:this.fontNames},st.load(e)}}class ot extends Phaser.Scene{constructor(){super("UIScene"),this.SCREEN_WIDTH=800,this.SCREEN_HEIGHT=600,this.UI_SIDEBAR_WIDTH=100,this.GAME_AREA_WIDTH=this.SCREEN_WIDTH-this.UI_SIDEBAR_WIDTH,this.TITLE_X=40,this.TITLE_Y=40,this.LOGIN_BUTTON_X=40,this.LOGIN_BUTTON_Y=560,this.RESTART_BUTTON_X=90,this.RESTART_BUTTON_Y=50,this.GAME_CLOCK_X=300,this.GAME_CLOCK_Y=10,this.WEATHER_X=540,this.WEATHER_Y=40,this.WEATHER_PANEL_X=360,this.WEATHER_PANEL_Y=200,this.FIRE_BUTTON_X=140,this.FIRE_BUTTON_Y=50,this.TILE_INFO_X=10,this.TILE_INFO_Y=80,this.ZOOM_PERCENT_TEXT_X=176,this.ZOOM_PERCENT_TEXT_Y=550,this.WIND_GAUGE_X=540,this.WIND_GAUGE_Y=60,this.WIND_GAUGE_WIDTH=100,this.WIND_GAUGE_HEIGHT=12,this.BUTTON_COLORS={DEFAULT:"#A0522D",HOVER:"#8B4513",FIRE_BUTTON:"#8B0000"},this.TILE_INFO_DISPLAY_TIME=3e3}preload(){var e;e=this,console.log("preloadHUD called"),e.load.image("coins","assets/coins.png"),e.load.image("open-shop","assets/UI/open-shop.png"),e.load.image("shop","assets/UI/shop.png"),e.load.image("add-to-cart","assets/UI/add-to-cart.png"),e.load.image("remove-from-cart","assets/UI/remove-from-cart.png"),e.load.image("toggle-add-to-cart","assets/UI/toggle-add-to-cart.png"),e.load.image("remove-button","assets/UI/remove-button.png"),e.load.image("purchase","assets/UI/purchase.png"),e.load.image("close","assets/UI/close.png"),e.load.image("no-funds","assets/UI/no-funds.png"),e.load.image("price-tag","assets/UI/price-tag.png"),e.load.image("hose-tooltip","assets/resources/tooltips/fire-hose.png"),e.load.image("extinguisher-tooltip","assets/resources/tooltips/fire-extinguisher.png"),e.load.image("helicopter-tooltip","assets/resources/tooltips/helicopter.png"),e.load.image("firetruck-tooltip","assets/resources/tooltips/firetruck.png"),e.load.image("airtanker-tooltip","assets/resources/tooltips/airtanker.png"),e.load.image("hotshot-crew-tooltip","assets/resources/tooltips/hotshot-crew.png"),e.load.image("smokejumper-tooltip","assets/resources/tooltips/smokejumpers.png"),e.load.image("hose","assets/resources/fire-hose.png"),e.load.image("extinguisher","assets/resources/fire-extinguisher.png"),e.load.image("helicopter","assets/resources/helicopter.png"),e.load.image("firetruck","assets/resources/firetruck.png"),e.load.image("airtanker","assets/resources/airtanker.png"),e.load.image("hotshot-crew","assets/resources/hotshot-crew.png"),e.load.image("smokejumper","assets/resources/smokejumpers.png"),e.load.image("active-hose","assets/resources/activated/fire-hose.png"),e.load.image("active-extinguisher","assets/resources/activated/fire-extinguisher.png"),e.load.image("active-helicopter","assets/resources/activated/helicopter.png"),e.load.image("active-firetruck","assets/resources/activated/firetruck.png"),e.load.image("active-airtanker","assets/resources/activated/airtanker.png"),e.load.image("active-hotshot-crew","assets/resources/activated/hotshot-crew.png"),e.load.image("active-smokejumper","assets/resources/activated/smokejumpers.png"),e.load.image("out-of-hoses","assets/resources/notifications/fire-hose.png"),e.load.image("out-of-fire-extinguishers","assets/resources/notifications/fire-extinguisher.png"),e.load.image("out-of-helicopters","assets/resources/notifications/helicopter.png"),e.load.image("out-of-firetrucks","assets/resources/notifications/firetruck.png"),e.load.image("out-of-airtankers","assets/resources/notifications/airtankers.png"),e.load.image("out-of-hotshots","assets/resources/notifications/hotshot-crews.png"),e.load.image("out-of-smokejumpers","assets/resources/notifications/smokejumpers.png"),e.load.image("cooldown","assets/resources/notifications/cooldown.png"),e.load.spritesheet("set-timer","assets/timer.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-hose","assets/64x64-Map-Tiles/Deployable%20Resources/fire-hose.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-extinguisher","assets/64x64-Map-Tiles/Deployable%20Resources/extinguisher.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-firetruck","assets//64x64-Map-Tiles/Deployable%20Resources/firetruck.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-helicopter","assets//64x64-Map-Tiles/Deployable%20Resources/helicopter.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-airtanker","assets//64x64-Map-Tiles/Deployable%20Resources/airtanker.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-hotshot","assets//64x64-Map-Tiles/Deployable%20Resources/hotshot-crew.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-smokejumpers","assets//64x64-Map-Tiles/Deployable%20Resources/smokejumpers.png",{frameWidth:64,frameHeight:64}),e.load.spritesheet("set-smokejumpers-dig","assets//64x64-Map-Tiles/Deployable%20Resources/trench-digger.png",{frameWidth:64,frameHeight:64}),this.load.addFile(new nt(this.load,"Press Start 2P")),this.load.image("weather_title_closed","assets/UI/weather_title_closed.png"),this.load.image("weather_title_opened","assets/UI/weather_title_opened.png"),this.load.image("humidity_full","assets/UI/humidity_full.png"),this.load.image("humidity_half","assets/UI/humidity_half.png"),this.load.image("humidity_low","assets/UI/humidity_low.png"),this.load.image("wind_1arrow","assets/UI/wind_1arrow.png"),this.load.image("wind_2arrow","assets/UI/wind_2arrow.png"),this.load.image("wind_3arrow","assets/UI/wind_3arrow.png"),this.load.image("wind-arrow","assets/UI/up.png"),this.load.image("up","assets/UI/up.png"),this.load.image("right","assets/UI/right.png"),this.load.image("down","assets/UI/down.png"),this.load.image("left","assets/UI/left.png"),this.load.image("weather_panel","assets/UI/weather_panel.png"),this.load.image("Title","assets/UI/Title.png"),this.load.image("drop_direction_vertical","assets/UI/drop_direction_vertical.png"),this.load.image("drop_direction_horizontal","assets/UI/drop_direction_horizontal.png"),this.load.image("toggle_ui_off","assets/UI/toggle_ui_off.png"),this.load.image("toggle_ui_on","assets/UI/toggle_ui_on.png")}create(){console.log("UIScene Created"),this.uiContainer=this.add.container(0,0),this.topBarContainer=this.add.container(0,0),this.bottomBarContainer=this.add.container(0,this.scale.height-60),this.uiToggleButtonContainer=this.add.container(0,0).setScrollFactor(0),this.createUIElements();const e=this.add.rectangle(this.SCREEN_WIDTH/2,30,this.SCREEN_WIDTH,60,2962486);e.setScrollFactor(0),e.setDepth(5),this.uiContainer.add(e),this.topBarContainer.setDepth(10),this.uiContainer.add(this.topBarContainer),this.hamburgerMenu=new it(this,{x:40,y:30,depth:1e3,openDirection:"left"}),this.accessibilityPanel=new tt(this,{depth:1001,onSettingsApplied:e=>{console.log("Accessibility settings applied:",e)}});const t=o(this,{x:120,y:30,width:80,height:30,backgroundColor:9109504,hoverColor:10824234,text:"Restart",fontSize:"10px",onClick:()=>{console.log("Restart clicked"),this.events.emit("restartGame")}});this.topBarContainer.add([t.button,t.buttonText]);const i=o(this,{x:200,y:30,width:80,height:30,backgroundColor:2263842,hoverColor:3050327,text:"Start",fontSize:"10px",onClick:()=>{console.log("Start Fire clicked"),this.events.emit("toggleFire")}});this.topBarContainer.add([i.button,i.buttonText]),this.gameClockText.setPosition(400,15,"Time: 00:00"),this.gameClockText.setOrigin(.5,0),this.gameClockText.setStyle({fontFamily:'"Press Start 2P"',fontSize:"16px",fontStyle:"normal",color:"#FFFFFF",align:"center",padding:{x:5,y:2}}),this.topBarContainer.add(this.gameClockText);const s=this.add.rectangle(this.scale.width/2,this.scale.height-30,this.scale.width,60,2962486).setScrollFactor(0);this.bottomBarContainer.add(s),this.createZoomControls(),this.createNavigationCompass(),this.zoomText.x,this.zoomText.width,function(e){console.log("createHUD called"),e.add.rectangle(745,300,110,600,2962486).setDepth(-1),console.log("Sidebar created"),q=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"cooldown").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),Q=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-hoses").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),ee=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-fire-extinguishers").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),te=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-helicopters").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),ie=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-firetrucks").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),se=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-airtankers").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),ne=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-hotshots").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),oe=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"out-of-smokejumpers").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),e.input.setDefaultCursor("url(assets/cursors/glove.png), pointer");const t=.8;Ce=e.add.sprite(550,560,"coins").setOrigin(.5,.5).setDepth(50).setScale(.23),J=e.add.text(610,560,"0",{fontFamily:'"Press Start 2P"',fontSize:"16px",fontStyle:"normal",color:"#FFFFFF"}).setOrigin(.5,.5).setDepth(50),Ie=e.add.sprite(660,560,"open-shop").setOrigin(.5,.5).setDepth(50).setScale(.23),Ie.setInteractive({useHandCursor:!0}).on("pointerover",(()=>{Ie.setAlpha(.8),Ie.fillColor=4473924})).on("pointerout",(()=>{Ie.setAlpha(1)})),function(e){B=e.add.text(310,210,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),Z=e.add.text(535,210,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),G=e.add.text(310,277,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),j=e.add.text(535,277,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),X=e.add.text(310,347,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),Y=e.add.text(535,347,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),K=e.add.text(310,417,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),re=e.add.text(210,483,"0",{fontFamily:'"Press Start 2P"',fontSize:"20px",fill:"#000000",align:"center",wordWrap:{width:80}}).setDepth(600).setVisible(!1);let t=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"shop").setScale(1).setDepth(500).setOrigin(.5,.5).setVisible(!1),i=e.add.sprite(180,70,"close").setScale(.23).setDepth(500).setOrigin(.5,.5).setVisible(!1),s=e.add.sprite(400,540,"remove-button").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),n=e.add.sprite(570,500,"purchase").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),o=e.add.sprite(e.cameras.main.width/2,e.cameras.main.height/2,"no-funds").setScale(1).setDepth(1100).setOrigin(.5,.5).setVisible(!1),r=e.add.sprite(360,210,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),a=e.add.sprite(590,210,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),l=e.add.sprite(360,277,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),h=e.add.sprite(590,277,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),c=e.add.sprite(360,347,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),d=e.add.sprite(590,347,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),p=e.add.sprite(360,417,"add-to-cart").setScale(.15).setDepth(501).setOrigin(.5,.5).setVisible(!1),k=e.add.sprite(380,180,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),v=e.add.text(393,170,"$150",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),M=e.add.sprite(620,180,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),E=e.add.text(633,170,"$25",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),O=e.add.sprite(390,250,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),_=e.add.text(403,240,"$300",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),A=e.add.sprite(620,250,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),D=e.add.text(633,240,"$250",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),V=e.add.sprite(390,320,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),R=e.add.text(403,310,"$250",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),$=e.add.sprite(620,320,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),L=e.add.text(633,310,"$700",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1),N=e.add.sprite(532,390,"price-tag").setScale(.3).setDepth(500).setOrigin(.5,.5).setVisible(!1),U=e.add.text(545,380,"$250",{fontFamily:'"Press Start 2P"',fontSize:"12px",fill:"#000000",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5).setDepth(600).setVisible(!1);!function(e,t,i,s,n,o,r,a,l,h,c,d,p,k,v,M,E,O,_,A,D,V,R,$,L,N,U,W){t.setInteractive(),s.setInteractive(),n.setInteractive(),o.setInteractive(),a.setInteractive(),l.setInteractive(),h.setInteractive(),c.setInteractive(),d.setInteractive(),p.setInteractive(),k.setInteractive(),function(e,t,i,s,n,o,r,a,l,h){s.on("pointerdown",(function(){1==ae?(me+=150,le+=1,B.setText(`${le}`),re.setText(`${me}`)):le>0&&(me-=150,le-=1,B.setText(`${le}`),re.setText(`${me}`))}),this),n.on("pointerdown",(function(){1==ae?(me+=25,he+=1,Z.setText(`${he}`),re.setText(`${me}`)):he>0&&(me-=25,he-=1,Z.setText(`${he}`),re.setText(`${me}`))}),this),o.on("pointerdown",(function(){1==ae?(me+=300,ce+=1,G.setText(`${ce}`),re.setText(`${me}`)):ce>0&&(me-=300,ce-=1,G.setText(`${ce}`),re.setText(`${me}`))}),this),r.on("pointerdown",(function(){1==ae?(me+=250,de+=1,j.setText(`${de}`),re.setText(`${me}`)):de>0&&(me-=250,de-=1,j.setText(`${de}`),re.setText(`${me}`))}),this),a.on("pointerdown",(function(){1==ae?(me+=250,pe+=1,X.setText(`${pe}`),re.setText(`${me}`)):pe>0&&(me-=250,pe-=1,X.setText(`${pe}`),re.setText(`${me}`))}),this),l.on("pointerdown",(function(){1==ae?(me+=700,ue+=1,Y.setText(`${ue}`),re.setText(`${me}`)):ue>0&&(me-=700,ue-=1,Y.setText(`${ue}`),re.setText(`${me}`))}),this),h.on("pointerdown",(function(){1==ae?(me+=250,ge+=1,K.setText(`${ge}`),re.setText(`${me}`)):ge>0&&(me-=250,ge-=1,K.setText(`${ge}`),re.setText(`${me}`))}),this),t.on("pointerdown",(function(t,s,n,o){let r=Re(me);console.log(`${Ve()}`),0==r?ze(e,i):(g(le),f(he),S(ce),y(de),w(pe),C(ue),P(ge),fe.setText(u()),xe.setText(m()),Se.setText(x()),be.setText(b()),ye.setText(T()),Te.setText(F()),we.setText(I()),re.setText(`${me}`),le=0,B.setText(`${le}`),he=0,Z.setText(`${he}`),ce=0,G.setText(`${ce}`),de=0,j.setText(`${de}`),pe=0,X.setText(`${pe}`),ue=0,Y.setText(`${ue}`),ge=0,K.setText(`${ge}`),J.setText(`${Ve()}`),re.setText("0"),me=0,Re(me),le=0,B.setText(`${le}`))}),this)}(e,o,r,a,l,h,c,d,p,k),t.on("pointerdown",(function(t,r,u,g){$e(Pe),e.input.setDefaultCursor("url(assets/cursors/glove.png), pointer"),i.setVisible(!0),s.setVisible(!0),n.setVisible(!0),o.setVisible(!0),a.setVisible(!0),l.setVisible(!0),h.setVisible(!0),c.setVisible(!0),d.setVisible(!0),p.setVisible(!0),k.setVisible(!0),B.setVisible(!0),Z.setVisible(!0),G.setVisible(!0),j.setVisible(!0),X.setVisible(!0),Y.setVisible(!0),K.setVisible(!0),re.setVisible(!0)}),this),s.on("pointerdown",(function(e,t,r,u){i.setVisible(!1),s.setVisible(!1),n.setVisible(!1),o.setVisible(!1),a.setVisible(!1),l.setVisible(!1),h.setVisible(!1),c.setVisible(!1),d.setVisible(!1),p.setVisible(!1),k.setVisible(!1),B.setVisible(!1),Z.setVisible(!1),G.setVisible(!1),j.setVisible(!1),X.setVisible(!1),Y.setVisible(!1),K.setVisible(!1),re.setVisible(!1)}),this),n.on("pointerdown",(function(e,t,i,s){1==ae?(n.setTexture("toggle-add-to-cart"),a.setTexture("remove-from-cart"),l.setTexture("remove-from-cart"),h.setTexture("remove-from-cart"),c.setTexture("remove-from-cart"),d.setTexture("remove-from-cart"),p.setTexture("remove-from-cart"),k.setTexture("remove-from-cart"),ae=!1):(n.setTexture("remove-button"),a.setTexture("add-to-cart"),l.setTexture("add-to-cart"),h.setTexture("add-to-cart"),c.setTexture("add-to-cart"),d.setTexture("add-to-cart"),p.setTexture("add-to-cart"),k.setTexture("add-to-cart"),ae=!0)}),this),t.on("pointerover",(()=>{t.setTint(16041334)})),t.on("pointerout",(()=>{t.clearTint()})),s.on("pointerover",(()=>{s.setTint(15558737)})),s.on("pointerout",(()=>{s.clearTint()})),n.on("pointerover",(()=>{n.setTint(15558737)})),n.on("pointerout",(()=>{n.clearTint()})),o.on("pointerover",(()=>{o.setTint(5156684)})),o.on("pointerout",(()=>{o.clearTint()})),a.on("pointerover",(()=>{a.setTint(5156684),v.angle=-35,M.angle=-35,v.setVisible(!0),M.setVisible(!0)})),a.on("pointerout",(()=>{a.clearTint(),v.setVisible(!1),M.setVisible(!1)})),l.on("pointerover",(()=>{l.setTint(5156684),E.angle=-35,O.angle=-35,E.setVisible(!0),O.setVisible(!0)})),l.on("pointerout",(()=>{l.clearTint(),E.setVisible(!1),O.setVisible(!1)})),h.on("pointerover",(()=>{h.setTint(5156684),_.angle=-35,A.angle=-35,_.setVisible(!0),A.setVisible(!0)})),h.on("pointerout",(()=>{h.clearTint(),_.setVisible(!1),A.setVisible(!1)})),c.on("pointerover",(()=>{c.setTint(5156684),D.angle=-35,V.angle=-35,D.setVisible(!0),V.setVisible(!0)})),c.on("pointerout",(()=>{c.clearTint(),D.setVisible(!1),V.setVisible(!1)})),d.on("pointerover",(()=>{d.setTint(5156684),R.angle=-35,$.angle=-35,R.setVisible(!0),$.setVisible(!0)})),d.on("pointerout",(()=>{d.clearTint(),R.setVisible(!1),$.setVisible(!1)})),p.on("pointerover",(()=>{p.setTint(5156684),L.angle=-35,N.angle=-35,L.setVisible(!0),N.setVisible(!0)})),p.on("pointerout",(()=>{p.clearTint(),L.setVisible(!1),N.setVisible(!1)})),k.on("pointerover",(()=>{k.setTint(5156684),U.angle=-35,W.angle=-35,U.setVisible(!0),W.setVisible(!0)})),k.on("pointerout",(()=>{k.clearTint(),U.setVisible(!1),W.setVisible(!1)}))}(e,Ie,t,i,s,n,o,r,a,l,h,c,d,p,k,v,M,E,O,_,A,D,V,R,$,L,N,U)}(e);let i=e.add.sprite(750,50,"hose").setScale(t).setDepth(1).setOrigin(.5,.5);i.name="hose",Pe[0]=i,fe=function(e,t,i,s){const n=s.add.text(750,90,"10 left",{fontFamily:'"Press Start 2P"',fontSize:"12px",color:"#FFFFFF",align:"center",backgroundColor:"#333333",padding:{x:6,y:4}}).setOrigin(.5,.5);return s.add.rectangle(750,90,n.width+12,n.height+8,3355443,.7).setOrigin(.5).setDepth(n.depth-1),n}(0,0,0,e),Fe=e.add.sprite(750,50,"set-timer").setDepth(10).setScale(1,1).setVisible(!1),Ue(0,i,"hose","assets/cursors/water.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(fe,e),We(i,"hose-tooltip",660,55,e);let s=e.add.image(750,130,"extinguisher").setScale(t).setOrigin(.5,.5);s.name="extinguisher",Pe[1]=s,xe=e.add.text(750,170,"5 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,s,"extinguisher","assets/cursors/fire-extinguisher.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(xe,e),We(s,"extinguisher-tooltip",660,135,e);let n=e.add.image(750,210,"helicopter").setScale(t).setOrigin(.5,.5);n.name="helicopter",Pe[2]=n,Se=e.add.text(750,250,"3 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,n,"helicopter","assets/cursors/helicopter.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(Se,e),We(n,"helicopter-tooltip",660,215,e);let o=e.add.image(750,290,"firetruck").setScale(t).setOrigin(.5,.5);o.name="firetruck",Pe[3]=o,be=e.add.text(750,330,"3 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,o,"firetruck","assets/cursors/firetruck.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(be,e),We(o,"firetruck-tooltip",660,295,e);let r=e.add.image(750,370,"airtanker").setScale(t).setOrigin(.5,.5);r.name="airtanker",Pe[4]=r,ye=e.add.text(750,410,"2 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,r,"airtanker","assets/cursors/airtanker.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(ye,e),We(r,"airtanker-tooltip",660,375,e);let a=e.add.image(750,450,"hotshot-crew").setScale(t).setOrigin(.5,.5);a.name="hotshot-crew",Pe[5]=a,Te=e.add.text(750,490,"1 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,a,"hotshot-crew","assets/cursors/hotshot-crew.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(Te,e),We(a,"hotshot-crew-tooltip",660,455,e);let l=e.add.image(750,530,"smokejumper").setScale(t).setOrigin(.5,.5);l.name="smokejumper",Pe[6]=l,we=e.add.text(750,570,"5 left",{font:"14px Arial",fill:"#ffffff",align:"center",wordWrap:{width:80}}).setOrigin(.5,.5),Ue(0,l,"smokejumper","assets/cursors/launch.png","assets/cursors/glove.png","WATER","NO-WATER",e),ke(we,e),We(l,"smokejumper-tooltip",660,535,e)}(this),this.bottomBarContainer.add([Ce,J,Ie]),Ce.setPosition(this.scale.width-450,0).setDepth(10),J.setPosition(this.scale.width-435,0).setDepth(10),Ie.setPosition(this.scale.width-360,0).setDepth(10),Ce.setDepth(1),J.setDepth(1),Ie.setDepth(Ie.depth+1),this.uiContainer.add([this.topBarContainer,this.bottomBarContainer]),this.input.keyboard.on("keydown-U",(()=>{this.toggleUI(!this.uiContainer.visible)})),this.hoseText=fe,this.extinguisherText=xe,this.helicopterText=Se,this.firetruckText=be,this.airtankerText=ye,this.hotshotcrewText=Te,this.smokejumperText=we,this.scene.get("MapScene").events.on("updateGameClock",this.updateGameClock,this),this.scene.get("MapScene").events.on("tileInfo",this.updateTileInfo,this),this.scene.get("MapScene").events.on("fireSimToggled",this.updateFireButton,this),this.scene.get("MapScene").events.on("zoomChanged",this.handleZoomChange,this),this.scene.get("MapScene").events.on("mapSizeChanged",this.updateMapInfo,this),this.scene.get("MapScene").events.on("scoreUpdated",this.updateScore,this),this.scene.get("MapScene").events.on("gameWon",(()=>{this.winText.setVisible(!0)}))}update(){this.hoseText&&(this.hoseText.setText(`${u()} left`),this.extinguisherText.setText(`${m()} left`),this.helicopterText.setText(`${x()} left`),this.firetruckText.setText(`${b()} left`),this.airtankerText.setText(`${T()} left`),this.hotshotcrewText.setText(`${F()} left`),this.smokejumperText.setText(`${I()} left`))}toggleUI(e=!0){this.uiContainer.setVisible(e),this.uiToggleButtonContainer.setVisible(!0);const t=e?"toggle_ui_on":"toggle_ui_off";this.uiToggleButton&&this.uiToggleButton.setTexture(t)}_createTooltip(e,t,i=-20){const s=this.add.text(0,0,t,{font:"14px Arial",fill:"#fff",backgroundColor:"#000",padding:{x:6,y:4}}).setOrigin(.5,1).setDepth(1e3).setScrollFactor(0).setVisible(!1);return e.on("pointerover",(()=>{s.setPosition(e.x,e.y+i).setVisible(!0)})).on("pointerout",(()=>s.setVisible(!1))),s}createUIElements(){this.riskText=this.add.text(-500,-500,"Risk: Low",{fontFamily:'"Press Start 2P"',fontSize:"16px",fontStyle:"normal",fill:"#00ff00",backgroundColor:"rgba(0,0,0,0.5)",padding:{x:4,y:2}}).setScrollFactor(0),this.gameClockText=this.add.text(this.GAME_CLOCK_X,this.GAME_CLOCK_Y,"Time: 00:00",{fontSize:"20px",fill:"#ffffff",backgroundColor:"rgba(0, 0, 0, 0.6)",padding:{x:10,y:6},align:"center",shadow:{offsetX:2,offsetY:2,color:"rgba(0, 0, 0, 0.7)",blur:4,stroke:!0,fill:!0}}).setScrollFactor(0).setDepth(10),this.uiContainer.add(this.gameClockText);const e=this.add.rectangle(400,40,150,8,3355443).setOrigin(.5,0).setScrollFactor(0);this.fireStepBar=this.add.rectangle(325,45,0,8,16729344).setOrigin(0,0).setScrollFactor(0),this.topBarContainer.add([e,this.fireStepBar]),this.tileInfoText=this.add.text(-500,-500,"Select tile",{fontFamily:'"Press Start 2P"',fontSize:"14px",fontStyle:"normal",fill:"#ffffff",backgroundColor:"#2d3436",padding:{x:14,y:10},align:"left"}).setDepth(-1).setScrollFactor(0),this.scoreText=this.add.text(550,15,"Score: 0",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#FFFFFF",backgroundColor:"rgba(0, 0, 0, 0.5)",padding:{x:8,y:4}}).setScrollFactor(0),this.topBarContainer.add(this.scoreText),this.winText=this.add.text(this.scale.width/2,this.scale.height/2,"YOU WIN!",{fontFamily:'"Press Start 2P"',fontSize:"24px",fill:"#00FF00",backgroundColor:"rgba(0,0,0,0.8)",padding:{x:20,y:10},align:"center"}).setOrigin(.5).setScrollFactor(0).setDepth(1e3).setVisible(!1),this.uiContainer.add(this.winText),this.directionPromptContainer=this.add.container(this.SCREEN_WIDTH/2,this.SCREEN_HEIGHT/2).setScrollFactor(0).setDepth(1001).setVisible(!1);const t=this.add.rectangle(0,0,350,200,0,.8).setOrigin(.5),i=this.add.text(0,-82,"Choose Drop Direction",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#FFFFFF"}).setOrigin(.5),s={fontFamily:'"Press Start 2P"',fontSize:"14px",color:"#ffffff",backgroundColor:"#444",padding:{x:14,y:8}},n=this.add.text(0,-40,"Vertical",s).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.directionPromptContainer.setVisible(!1),this.events.emit("directionChosen","vertical")})),o=this.add.text(0,0,"Horizontal",s).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.directionPromptContainer.setVisible(!1),this.events.emit("directionChosen","horizontal")})),r=this.add.text(0,40,"Cancel",s).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.directionPromptContainer.setVisible(!1),this.events.emit("directionChosen",null)}));this.directionPromptContainer.add([t,i,n,o,r]),this.uiContainer.add(this.directionPromptContainer)}createZoomControls(){const e=o(this,{x:200,y:0,width:40,height:40,backgroundColor:6710886,hoverColor:8947848,text:"+",fontSize:"20px",onClick:()=>{const e=this.scene.get("MapScene");e.currentZoom=Phaser.Math.Clamp(e.currentZoom+.1,e.MIN_ZOOM,e.MAX_ZOOM),e.cameras.main.setZoom(e.currentZoom),this.handleZoomChange(e.currentZoom)}}),t=o(this,{x:260,y:0,width:40,height:40,backgroundColor:6710886,hoverColor:8947848,text:"-",fontSize:"20px",onClick:()=>{const e=this.scene.get("MapScene");e.currentZoom=Phaser.Math.Clamp(e.currentZoom-.1,e.MIN_ZOOM,e.MAX_ZOOM),e.cameras.main.setZoom(e.currentZoom),this.handleZoomChange(e.currentZoom)}});this.uiToggleButton=this.add.image(-60,420,"toggle_ui_on").setInteractive().setScrollFactor(0).setDisplaySize(32,32).on("pointerover",(()=>this.uiToggleButton.setTint(12303291))).on("pointerout",(()=>this.uiToggleButton.clearTint())).on("pointerdown",(()=>{const e=!this.uiContainer.visible;this.toggleUI(e);const t=e?"toggle_ui_on":"toggle_ui_off";this.uiToggleButton.setTexture(t)})),this.uiToggleButtonContainer=this.add.container(650,this.scale.height-60,[this.uiToggleButton]).setScrollFactor(0);const i=this.add.graphics();i.fillStyle(5592405,1),i.fillRoundedRect(-25,-25,50,50,8),i.setInteractive(new Phaser.Geom.Rectangle(-25,-25,50,50),Phaser.Geom.Rectangle.Contains),i.on("pointerover",(()=>{i.clear(),i.fillStyle(7829367,1),i.fillRoundedRect(-25,-25,50,50,8)})),i.on("pointerout",(()=>{i.clear(),i.fillStyle(5592405,1),i.fillRoundedRect(-25,-25,50,50,8)})),this.uiToggleButtonContainer.removeAll(),this.uiToggleButton.setPosition(0,0),this.uiToggleButtonContainer.add([i,this.uiToggleButton]),this.zoomText=this.add.text(170,576,"Zoom: 100%",{fontFamily:'"Press Start 2P"',fontSize:"12px",fontStyle:"normal",color:"#FFFFFF"}).setOrigin(0,.5).setScrollFactor(0),this.zoomInButton=e.button,this.zoomOutButton=t.button,this.bottomBarContainer.add(this.zoomText),this.bottomBarContainer.add([e.button,e.buttonText,t.button,t.buttonText]);const s=this.add.graphics();s.fillStyle(5592405,1),s.fillRoundedRect(-25,-25,50,50,8),s.setInteractive(new Phaser.Geom.Rectangle(-25,-25,50,50),Phaser.Geom.Rectangle.Contains),s.on("pointerover",(()=>{s.clear(),s.fillStyle(7829367,1),s.fillRoundedRect(-25,-25,50,50,8)})),s.on("pointerout",(()=>{s.clear(),s.fillStyle(5592405,1),s.fillRoundedRect(-25,-25,50,50,8)}));const n=this.add.text(0,0,"i",{fontFamily:'"Press Start 2P"',fontSize:"20px",color:"#FFFFFF"}).setOrigin(.5);this.infoButtonContainer=this.add.container(575,540,[s,n]).setScrollFactor(0),this.infoButtonContainer.setDepth(100),this.infoPanel=this.add.container(400,300).setScrollFactor(0).setVisible(!1);const r=this.add.rectangle(0,0,300,200,3355443,.9).setOrigin(.5).setStrokeStyle(2,16777215),a=this.add.text(130,-85,"X",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#FFFFFF"}).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.infoPanel.setVisible(!1)}));this.infoPanelTitle=this.add.text(0,-85,"Game Info",{fontFamily:'"Press Start 2P"',fontSize:"16px",color:"#FFFFFF"}).setOrigin(.5),this.infoPanelTile=this.add.text(-130,-60,"Tile: N/A",{fontFamily:'"Press Start 2P"',fontSize:"12px",color:"#FFFFFF"}).setOrigin(0,0),this.infoPanelWind=this.add.text(-130,0,"Wind: N/A",{fontFamily:'"Press Start 2P"',fontSize:"12px",color:"#FFFFFF"}).setOrigin(0,0),this.infoPanelRisk=this.add.text(-130,60,"Risk: N/A",{fontFamily:'"Press Start 2P"',fontSize:"12px",color:"#FFFFFF"}).setOrigin(0,0),this.infoPanel.add([r,this.infoPanelTitle,a,this.infoPanelTile,this.infoPanelWind,this.infoPanelRisk]),this.uiContainer.add(this.infoPanel),s.on("pointerdown",(()=>{this.updateInfoPanel(),this.infoPanel.setVisible(!this.infoPanel.visible)})),this.uiContainer.add(this.infoButtonContainer)}createNavigationCompass(){const e=this.add.circle(90,0,10,5592405).setScrollFactor(0);this.bottomBarContainer.add(e),[{key:"up",x:0,y:-1,posX:90,posY:-35},{key:"right",x:1,y:0,posX:125,posY:0},{key:"down",x:0,y:1,posX:90,posY:35},{key:"left",x:-1,y:0,posX:55,posY:0}].forEach((e=>{const t=this.add.image(e.posX,e.posY,e.key).setDisplaySize(30,30).setScrollFactor(0).setInteractive().on("pointerdown",(()=>this.events.emit("panStart",{x:e.x,y:e.y}))).on("pointerup",(()=>this.events.emit("panStop"))).on("pointerout",(()=>this.events.emit("panStop")));this.bottomBarContainer.add(t)}))}updateFireProgress(e){if(!this.fireStepBar)return;const t=Phaser.Math.Clamp(e/100*150,0,150);this.fireStepBar.width=t;let i=65280;e>66?i=16711680:e>33&&(i=16776960),this.fireStepBar.fillColor=i}updateScore(e){this.scoreText&&this.scoreText.setText(`Score: ${e}`)}updateGameClock(e){let t=Math.floor(e/60),i=Math.floor(e%60),s=`${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`;this.gameClockText.setText(`Time: ${s}`)}updateTileInfo(e){console.log(`Updating tile info: ${e.terrain}, ${e.flammability}, ${e.fuel}, ${e.burnStatus}`),this.tileInfoText?(this.tileInfoText.setText(`Terrain: ${e.terrain}\nFlammability: ${e.flammability}\nFuel: ${e.fuel}\nBurn Status: ${e.burnStatus}`),this.tileInfoText.setVisible(!0),this.tileInfoText.setDepth(100),this.selectedTile=e,this.tileInfoHideTimer&&(this.tileInfoHideTimer.remove(),this.tileInfoHideTimer=null),this.updateInfoPanel()):console.warn("tileInfoText is not defined in UIScene!")}updateWindDisplay(e){const t=Phaser.Math.Clamp(e.windSpeed/50,0,1);this.windGaugeFill.width=this.WIND_GAUGE_WIDTH*t,this.windArrow.setRotation(Phaser.Math.DegToRad({N:-90,E:0,S:90,W:180}[e.windDirection]||0)),this.windGaugeFill.fillColor=t<.33?65280:t<.66?16776960:16711680}updateFireButton(e){this.fireButton&&this.fireButton.buttonText&&this.fireButton.buttonText.setText(e?"Stop":"Start")}updateRiskDisplay(e){this.riskText.setText(`Risk: ${e.charAt(0).toUpperCase()+e.slice(1)}`).setStyle({fill:{low:"#00ff00",medium:"#ffff00",high:"#ff0000"}[e]})}handleZoomChange(e){const t=Math.round(100*e);this.zoomText.setText(`Zoom: ${t}%`)}updateMapInfo(e){console.log(`Map size changed: ${e.width}x${e.height} tiles, ${e.pixelWidth}x${e.pixelHeight} pixels`)}updateInfoPanel(){this.selectedTile?this.infoPanelTile.setText(`Terrain: ${this.selectedTile.terrain}\nFlammability: ${this.selectedTile.flammability}\nFuel: ${this.selectedTile.fuel}\nStatus: ${this.selectedTile.burnStatus}`):this.infoPanelTile.setText("Tile: No tile selected");const e=this.scene.get("MapScene");e.weather&&(this.infoPanelWind.setText(`Wind Direction: ${e.weather.windDirection}\nWind Speed: ${e.weather.windSpeed} mph\nTemperature: ${e.weather.temperature}F\nHumidity: ${e.weather.humidity}%`),this.infoPanelRisk.setText(`Risk: ${e.weather.getRiskCategory()}`))}}var rt=i(223),at=i(875),lt=i(594);const ht=(0,rt.Wp)({apiKey:"AIzaSyD1dJCegF2BZ5c01e4URiJrBPboHMqIhnI",authDomain:"wildfire-command.firebaseapp.com",projectId:"wildfire-command",storageBucket:"wildfire-command.firebasestorage.app",messagingSenderId:"824434588817",appId:"1:824434588817:web:c3276917d57b972c8a1330"}),ct=(0,at.xI)(ht),dt=(0,lt.aU)(ht);class pt extends s.Scene{constructor(){super({key:"SignupScene"})}preload(){}create(){this.input.keyboard.removeCapture([s.Input.Keyboard.KeyCodes.W,s.Input.Keyboard.KeyCodes.A,s.Input.Keyboard.KeyCodes.S,s.Input.Keyboard.KeyCodes.D]),this.add.text(400,120,"Sign Up",{fontSize:"25px",fill:"#FFD700",fontFamily:'"Press Start 2P", cursive',stroke:"#000",strokeThickness:4}).setOrigin(.5);const e={};[{placeholder:"Username",y:180,type:"text"},{placeholder:"Email",y:230,type:"email"},{placeholder:"Password",y:280,type:"password"},{placeholder:"Repeat Password",y:330,type:"password"}].forEach((t=>{const i=this.add.dom(400,t.y,"input",{width:"500px",height:"30px",fontSize:"16px",padding:"5px"}).setOrigin(.5);i.node.setAttribute("type",t.type),i.node.setAttribute("placeholder",t.placeholder),i.node.classList.add("input-field"),e[t.placeholder]=i}));const t=this.add.dom(470,390,"button",{width:"140px",height:"30px",fontSize:"12px",color:"#FFFFFF",backgroundColor:"#228B22",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"SIGN UP").setOrigin(.5);t.addListener("click"),t.on("click",(()=>{const t=e.Username.node.value.trim(),i=e.Email.node.value.trim(),s=e.Password.node.value,n=e["Repeat Password"].node.value;t&&i&&s&&n?s===n?(0,at.eJ)(ct,i,s).then((async e=>{const i=e.user;await(0,at.r7)(i,{displayName:t}),await(0,lt.BN)((0,lt.H9)(dt,"users",i.uid),{displayName:t,email:i.email,createdAt:new Date}),this.scene.start("MapScene"),this.scene.launch("UIScene"),this.startGame()})).catch((e=>alert("Sign up failed: "+e.message))):alert("Passwords do not match."):alert("Please fill in all fields.")}));const i=this.add.dom(315,390,"button",{width:"140px",height:"30px",fontSize:"12px",color:"#FFFFFF",backgroundColor:"#555555",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"LOGIN").setOrigin(.5);i.addListener("click"),i.on("click",(()=>{this.scene.start("LoginScene")}))}startGame(){console.log("Restarting game..."),sessionStorage.setItem("skipIntro","true"),window.location.reload()}}class ut extends s.Scene{constructor(){super({key:"LoginScene"})}preload(){}create(){this.scene.isActive("MapScene")&&this.scene.stop("MapScene"),this.input.keyboard.removeCapture([s.Input.Keyboard.KeyCodes.W,s.Input.Keyboard.KeyCodes.A,s.Input.Keyboard.KeyCodes.S,s.Input.Keyboard.KeyCodes.D]),this.add.text(400,150,"Log In",{fontSize:"25px",fill:"#FFD700",fontFamily:'"Press Start 2P", cursive',stroke:"#000",strokeThickness:4}).setOrigin(.5);const e=this.add.dom(400,200,"input",{width:"500px",height:"30px",fontSize:"16px",padding:"5px"}).setOrigin(.5);e.node.setAttribute("type","email"),e.node.setAttribute("name","email"),e.node.setAttribute("placeholder","Email"),e.node.classList.add("input-field");const t=this.add.dom(400,260,"input",{width:"500px",height:"30px",fontSize:"16px",padding:"5px"}).setOrigin(.5);t.node.setAttribute("type","password"),t.node.setAttribute("name","password"),t.node.setAttribute("placeholder","Password"),t.node.classList.add("input-field");const i=this.add.dom(470,320,"button",{width:"140px",height:"30px",fontSize:"12px",color:"#FFFFFF",backgroundColor:"#228B22",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"LOGIN").setOrigin(.5);i.addListener("click"),i.on("click",(()=>{const i=e.node.value,s=t.node.value;i&&s?(0,at.x9)(ct,i,s).then((e=>{console.log("Login successful:",e),this.scene.start("MapScene"),this.scene.launch("UIScene"),this.startGame()})).catch((e=>{console.error("Login error:",e),alert(`Login failed: ${e.message}`)})):alert("Please enter both email and password.")}));const n=this.add.dom(315,320,"button",{width:"140px",height:"30px",fontSize:"12px",color:"#FFFFFF",backgroundColor:"#555555",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"NEW USER?").setOrigin(.5);n.addListener("click"),n.on("click",(()=>{this.scene.start("SignupScene")})),ct.onAuthStateChanged((e=>{e?(this.logoutButton=this.add.dom(50,20,"button",{width:"100px",height:"30px",fontSize:"12px",color:"#FFFFFF",backgroundColor:"#8B0000",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"LOGOUT").setOrigin(0,0),this.logoutButton.addListener("click"),this.logoutButton.on("click",(()=>{(0,at.CI)(ct).then((()=>{console.log("User logged out"),this.startGame()})).catch((e=>console.error("Logout failed:",e)))}))):this.logoutButton&&(this.logoutButton.destroy(),this.logoutButton=null)}));const o=this.add.dom(395,370,"button",{width:"200px",height:"30px",fontSize:"14px",color:"#FFFFFF",backgroundColor:"#8B0000",fontFamily:'"Press Start 2P", cursive',border:"2px solid #FFFFFF",cursor:"pointer"},"MAIN MENU").setOrigin(.5);o.addListener("click"),o.on("click",(()=>{console.log("PLAY button clicked - starting game"),this.startGame()}))}startGame(){console.log("Restarting game..."),sessionStorage.setItem("skipIntro","true"),window.location.reload()}}class gt extends s.Scene{constructor(){super({key:"ProfileScene"})}preload(){}async create(){const e=ct.currentUser,t=e?e.displayName:"Guest",i=.5*this.cameras.main.width,s=.38*this.cameras.main.height,{width:n,height:o}=this.scale;this.add.rectangle(0,0,n,o,0,.7).setOrigin(0).setInteractive();const r=this.scene.get("MapScene");if(!r||"function"!=typeof r.getTopNScores)return void console.warn("MapScene or getTopNScores not available");const a=(await r.getTopNScores(5)).map(((e,t)=>`<li style="\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 4px 0;\n            border-bottom: 1px solid rgba(255,215,0,0.3);\n          ">\n            <span>#${t+1}</span>\n            <span>${e}</span>\n          </li>\n        `)).join("");if(this.scorePanel=this.add.dom(i,s,"div",{width:"500px",maxHeight:"500px",overflowY:"auto",backgroundColor:"rgba(0, 0, 0, 0.85)",border:"3px solid #FFFFFF",borderRadius:"10px",padding:"12px",boxSizing:"border-box",fontFamily:'"Press Start 2P", cursive',color:"#FFD700",textAlign:"center",fontSize:"16px"},"").setOrigin(.5),e){const e=`\n            <h2 style="text-align:center; margin:0 0 12px;">${t}'s High Scores</h2>\n\n            \x3c!-- header flex row --\x3e\n            <div class="leader-header" style="\n                display:flex;\n                justify-content:space-between;\n                font-weight:bold;\n                padding:6px 0;\n                border-bottom:2px solid #FFD700;\n            ">\n                <span>Rank</span>\n                <span>Score</span>\n            </div>\n\n            <ol class="score-list">\n                ${a}\n            </ol>\n        `;this.scorePanel.node.innerHTML=e}else{const e="\n        <h2>Please sign up if would like to save your scores</h2>\n    ";this.scorePanel.node.innerHTML=e}this.scorePanel.node.classList.add("score-panel");const l=document.createElement("style");l.textContent="\n    .score-panel .score-list {\n        list-style-type: none !important;  /* remove default numbering */\n        margin: 0;\n        padding-left: 0 !important;        /* remove indent */\n    }\n    .score-panel .score-list li {\n        padding: 4px 0;                     /* vertical spacing */\n        border-bottom: 1px solid rgba(255,215,0,0.3);  /* subtle separators */\n        color: #FFFFFF;\n    }\n    .score-panel .score-list li:last-child {\n        border-bottom: none;                /* no line after last item */\n    }\n    .score-panel h2 {\n        color: #FFD700;\n        font-size: 20px;\n    }\n    ",document.head.append(l),this.scorePanel.node.clientHeight;const h=this.add.text(30,10,"",{fontSize:"24px",color:"#fff",backgroundColor:"transparent",fontFamily:'"Press Start 2P", cursive'}).setOrigin(1,0).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.scene.stop()));h.on("pointerover",(()=>h.setStyle({color:"#f00"}))),h.on("pointerout",(()=>h.setStyle({color:"#fff"}))),this.scale.on("resize",(e=>{const{width:t,height:i}=e;this.scorePanel.setPosition(.5*t,.38*i)}))}}class mt extends s.Scene{constructor(){super({key:"LeaderboardScene"})}preload(){}async create(){ct.currentUser;const e=.5*this.cameras.main.width,t=.38*this.cameras.main.height,{width:i,height:s}=this.scale;this.add.rectangle(0,0,i,s,0,.7).setOrigin(0).setInteractive();const n=this.scene.get("MapScene");if(!n||"function"!=typeof n.getGlobalTopNScores)return void console.warn("MapScene or getGlobalTopNScores not available");const o=(await n.getGlobalTopNScores(5)).map((({displayName:e,score:t},i)=>`\n          <li style="\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 4px 0;\n            border-bottom: 1px solid rgba(255,215,0,0.3);\n          ">\n            <span>#${i+1}</span>\n            <span>${e}</span>\n            <span>${t}</span>\n          </li>\n        `)).join("");this.scorePanel=this.add.dom(e,t,"div",{width:"600px",maxHeight:"400px",overflowY:"auto",backgroundColor:"rgba(0, 0, 0, 0.85)",border:"3px solid #FFFFFF",borderRadius:"10px",padding:"16px",boxSizing:"border-box",fontFamily:'"Press Start 2P", cursive',color:"#FFD700",textAlign:"left",fontSize:"16px",lineHeight:"1.4"},"").setOrigin(.5);const r=`\n      <h2 style="text-align:center; margin:0 0 12px;">Global Leaderboard</h2>\n\n      \x3c!-- header flex row --\x3e\n      <div class="leader-header" style="\n        display:flex;\n        justify-content:space-between;\n        font-weight:bold;\n        padding:6px 0;\n        border-bottom:2px solid #FFD700;\n      ">\n        <span>Rank</span>\n        <span>&nbsp;Name</span>\n        <span>Score</span>\n      </div>\n\n      <ol class="leader-list">\n        ${o}\n      </ol>\n    `;this.scorePanel.node.innerHTML=r,this.scorePanel.node.classList.add("leader-panel");const a=document.createElement("style");a.textContent="\n      .leader-panel .leader-list {\n        list-style-type: none;\n        margin: 0;\n        padding-left: 0;\n      }\n      .leader-panel .leader-list li {\n        padding: 6px 0;\n        border-bottom: 1px solid rgba(255,215,0,0.3);\n        color: #FFFFFF;\n      }\n      .leader-panel .leader-list li:last-child {\n        border-bottom: none;\n      }\n      .leader-panel h2 {\n        color: #FFD700;\n        font-size: 20px;\n      }\n      .leader-panel li strong {\n        color: #FFD700;\n      }\n    ",document.head.appendChild(a);const l=this.add.text(30,10,"",{fontSize:"24px",color:"#fff",backgroundColor:"transparent",fontFamily:'"Press Start 2P", cursive'}).setOrigin(1,0).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.scene.stop()));l.on("pointerover",(()=>l.setStyle({color:"#f00"}))),l.on("pointerout",(()=>l.setStyle({color:"#fff"}))),this.scale.on("resize",(e=>{const{width:t,height:i}=e;this.scorePanel.setPosition(.5*t,.38*i)}))}}console.log("Phaser Game Initializing...");const ft={type:s.AUTO,width:800,height:600,parent:"game-container",scene:[n,k,pt,ut,et,ot,gt,mt],backgroundColor:"#282c34",scale:{mode:s.Scale.FIT,autoCenter:s.Scale.CENTER_BOTH},dom:{createContainer:!0}};new s.Game(ft)}},e=>{e.O(0,[401],(()=>e(e.s=798))),e.O()}]);